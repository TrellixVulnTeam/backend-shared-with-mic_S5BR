!function(){"use strict";function e(t,r,n){return(e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(t,r,n||t)}function t(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=d(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw i}}}}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=a(e);if(t){var o=a(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return i(this,r)}}function i(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,o,i=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);s=!0);}catch(c){a=!0,o=c}finally{try{s||null==r.return||r.return()}finally{if(a)throw o}}return i}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e}(self.webpackChunk_vendure_admin_ui=self.webpackChunk_vendure_admin_ui||[]).push([[776],{86776:function(n,i,d){d.r(i),d.d(i,{AddCustomerToGroupDialogComponent:function(){return j},AddressCardComponent:function(){return me},AddressDetailDialogComponent:function(){return K},CustomerDetailComponent:function(){return Lt},CustomerGroupDetailDialogComponent:function(){return Gt},CustomerGroupListComponent:function(){return nr},CustomerGroupMemberListComponent:function(){return P},CustomerHistoryComponent:function(){return pt},CustomerListComponent:function(){return ur},CustomerModule:function(){return pr},CustomerResolver:function(){return lr},CustomerStatusLabelComponent:function(){return Fe},SelectCustomerGroupDialogComponent:function(){return Ne},customerBreadcrumb:function(){return mr},customerRoutes:function(){return dr}});var m=d(76491),f=d(79902),v=d(33927),h=d(30464),Z=d(83671),y=d(20309),b=d(1707),A=d(79441),x=d(61486),C=d(1143),T=d(83720),_=d(80639),w=d(14921),q=d(22663),U=d(16320),N=d(57890),O=d(20365),S=d(30901),I=d(28899),k=d(70325),J=d(54364),F=d(97388),L=function(e){return["/customer","customers",e]};function D(e,t){if(1&e&&(h.TgZ(0,"td",3),h._uU(1),h.qZA(),h.TgZ(2,"td",3),h._uU(3),h.qZA(),h.TgZ(4,"td",4),h._UZ(5,"vdr-table-row-action",5),h.ALo(6,"translate"),h.qZA()),2&e){var r=t.item;h.xp6(1),h.lnq(" ",r.title," ",r.firstName," ",r.lastName," "),h.xp6(2),h.Oqu(r.emailAddress),h.xp6(2),h.Q6J("label",h.lcZ(6,6,"common.edit"))("linkTo",h.VKq(8,L,r.id))}}var P=function(){function e(t,r){var n=this;p(this,e),this.router=t,this.dataService=r,this.selectedMemberIds=[],this.selectionChange=new h.vpe,this.fetchParamsChange=new h.vpe,this.filterTermControl=new b.NI(""),this.refresh$=new m.X(!0),this.destroy$=new A.xQ,this.isMemberSelected=function(e){return-1<n.selectedMemberIds.indexOf(e.id)}}return g(e,[{key:"ngOnInit",value:function(){var e=this;this.membersCurrentPage$=this.route.paramMap.pipe((0,v.U)(function(e){return e.get("membersPage")}),(0,v.U)(function(e){return e?+e:1}),(0,C.O)(1),(0,T.x)()),this.membersItemsPerPage$=this.route.paramMap.pipe((0,v.U)(function(e){return e.get("membersPerPage")}),(0,v.U)(function(e){return e?+e:10}),(0,C.O)(10),(0,T.x)());var t=this.filterTermControl.valueChanges.pipe((0,_.b)(250),(0,w.b)(function(){return e.setContentsPageNumber(1)}),(0,C.O)(""));(0,x.aj)(this.membersCurrentPage$,this.membersItemsPerPage$,t,this.refresh$).pipe((0,q.R)(this.destroy$)).subscribe(function(t){var r=l(t,3),n=r[0],o=r[1],i=r[2],s=o,a=(n-1)*o;e.fetchParamsChange.emit({filterTerm:i,skip:a,take:s})})}},{key:"ngOnDestroy",value:function(){this.destroy$.next(),this.destroy$.complete()}},{key:"setContentsPageNumber",value:function(e){this.setParam("membersPage",e)}},{key:"setContentsItemsPerPage",value:function(e){this.setParam("membersPerPage",e)}},{key:"refresh",value:function(){this.refresh$.next(!0)}},{key:"setParam",value:function(e,t){this.router.navigate(["./",Object.assign(Object.assign({},this.route.snapshot.params),u({},e,t))],{relativeTo:this.route,queryParamsHandling:"merge"})}},{key:"areAllSelected",value:function(){return!!this.members&&this.selectedMemberIds.length===this.members.length}},{key:"toggleSelectAll",value:function(){this.areAllSelected()?this.selectionChange.emit([]):this.selectionChange.emit(this.members.map(function(e){return e.id}))}},{key:"toggleSelectMember",value:function(e){this.selectedMemberIds.includes(e.id)?this.selectionChange.emit(this.selectedMemberIds.filter(function(t){return t!==e.id})):this.selectionChange.emit([].concat(c(this.selectedMemberIds),[e.id]))}}]),e}();P.\u0275fac=function(e){return new(e||P)(h.Y36(U.F0),h.Y36(Z.DoR))},P.\u0275cmp=h.Xpm({type:P,selectors:[["vdr-customer-group-member-list"]],inputs:{members:"members",totalItems:"totalItems",route:"route",selectedMemberIds:"selectedMemberIds"},outputs:{selectionChange:"selectionChange",fetchParamsChange:"fetchParamsChange"},decls:14,vars:24,consts:[["type","text","name","searchTerm",1,"search-input",3,"formControl","placeholder"],[3,"items","itemsPerPage","totalItems","currentPage","allSelected","isRowSelectedFn","pageChange","itemsPerPageChange","rowSelectChange","allSelectChange"],[3,"expand"],[1,"left","align-middle"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"]],template:function(e,t){1&e&&(h._UZ(0,"input",0),h.ALo(1,"translate"),h.TgZ(2,"vdr-data-table",1),h.NdJ("pageChange",function(e){return t.setContentsPageNumber(e)})("itemsPerPageChange",function(e){return t.setContentsItemsPerPage(e)})("rowSelectChange",function(e){return t.toggleSelectMember(e)})("allSelectChange",function(){return t.toggleSelectAll()}),h.ALo(3,"async"),h.ALo(4,"async"),h.ALo(5,"hasPermission"),h.TgZ(6,"vdr-dt-column",2),h._uU(7),h.ALo(8,"translate"),h.qZA(),h.TgZ(9,"vdr-dt-column",2),h._uU(10),h.ALo(11,"translate"),h.qZA(),h._UZ(12,"vdr-dt-column"),h.YNc(13,D,7,10,"ng-template"),h.qZA()),2&e&&(h.Q6J("formControl",t.filterTermControl)("placeholder",h.lcZ(1,12,"customer.search-customers-by-email")),h.xp6(2),h.Q6J("items",t.members)("itemsPerPage",h.lcZ(3,14,t.membersItemsPerPage$))("totalItems",t.totalItems)("currentPage",h.lcZ(4,16,t.membersCurrentPage$))("allSelected",t.areAllSelected())("isRowSelectedFn",h.lcZ(5,18,"UpdateCustomerGroup")&&t.isMemberSelected),h.xp6(4),h.Q6J("expand",!0),h.xp6(1),h.Oqu(h.lcZ(8,20,"customer.name")),h.xp6(2),h.Q6J("expand",!0),h.xp6(1),h.Oqu(h.lcZ(11,22,"customer.email-address")))},directives:[N.y,b.Fj,b.JJ,b.oH,O.Q,S.E,I.v],pipes:[k.X$,J.Ov,F.j],styles:[""],changeDetection:0});var M=d(98318),E=function(e){return{groupName:e}};function Q(e,t){if(1&e&&(h._uU(0),h.ALo(1,"translate")),2&e){var r=h.oxw();h.hij(" ",h.xi3(1,1,"customer.add-customers-to-group-with-name",h.VKq(4,E,r.group.name)),"\n")}}var $=function(e){return{count:e}};function Y(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"button",3),h.NdJ("click",function(){return h.CHM(r),h.oxw().cancel()}),h._uU(1),h.ALo(2,"translate"),h.qZA(),h.TgZ(3,"button",4),h.NdJ("click",function(){return h.CHM(r),h.oxw().add()}),h._uU(4),h.ALo(5,"translate"),h.qZA()}if(2&e){var n=h.oxw();h.xp6(1),h.Oqu(h.lcZ(2,3,"common.cancel")),h.xp6(2),h.Q6J("disabled",!n.selectedCustomerIds.length),h.xp6(1),h.hij(" ",h.xi3(5,5,"customer.add-customers-to-group-with-count",h.VKq(8,$,n.selectedCustomerIds.length))," ")}}var j=function(){function e(t){p(this,e),this.dataService=t,this.selectedCustomerIds=[],this.fetchGroupMembers$=new m.X({skip:0,take:10,filterTerm:""})}return g(e,[{key:"ngOnInit",value:function(){var e=this,t=this.fetchGroupMembers$.pipe((0,f.w)(function(t){var r=t.skip,n=t.take,o=t.filterTerm;return e.dataService.customer.getCustomerList(n,r,o).mapStream(function(e){return e.customers})}));this.customers$=t.pipe((0,v.U)(function(e){return e.items})),this.customersTotal$=t.pipe((0,v.U)(function(e){return e.totalItems}))}},{key:"cancel",value:function(){this.resolveWith()}},{key:"add",value:function(){this.resolveWith(this.selectedCustomerIds)}}]),e}();j.\u0275fac=function(e){return new(e||j)(h.Y36(Z.DoR))},j.\u0275cmp=h.Xpm({type:j,selectors:[["vdr-add-customer-to-group-dialog"]],decls:5,vars:8,consts:[["vdrDialogTitle",""],[3,"members","totalItems","route","selectedMemberIds","fetchParamsChange","selectionChange"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(h.YNc(0,Q,2,6,"ng-template",0),h.TgZ(1,"vdr-customer-group-member-list",1),h.NdJ("fetchParamsChange",function(e){return t.fetchGroupMembers$.next(e)})("selectionChange",function(e){return t.selectedCustomerIds=e}),h.ALo(2,"async"),h.ALo(3,"async"),h.qZA(),h.YNc(4,Y,6,10,"ng-template",2)),2&e&&(h.xp6(1),h.Q6J("members",h.lcZ(2,4,t.customers$))("totalItems",h.lcZ(3,6,t.customersTotal$))("route",t.route)("selectedMemberIds",t.selectedCustomerIds))},directives:[y.q,P,M.n],pipes:[J.Ov,k.X$],styles:[""],changeDetection:0});var G=d(9170),R=d(53466),B=d(1480);function H(e,t){if(1&e&&(h.TgZ(0,"span"),h._uU(1),h.qZA()),2&e){var r=t.ngIf;h.xp6(1),h.hij("",r,",")}}function V(e,t){if(1&e&&(h.TgZ(0,"span"),h._uU(1),h.qZA()),2&e){var r=t.ngIf;h.xp6(1),h.hij(" ",r,"")}}function X(e,t){if(1&e&&(h.YNc(0,H,2,1,"span",3),h.YNc(1,V,2,1,"span",3)),2&e){var r,n,o=h.oxw();h.Q6J("ngIf",null==(r=o.addressForm.get("streetLine1"))?null:r.value),h.xp6(1),h.Q6J("ngIf",null==(n=o.addressForm.get("countryCode"))?null:n.value)}}function W(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"button",4),h.NdJ("click",function(){return h.CHM(r),h.oxw().cancel()}),h._uU(1),h.ALo(2,"translate"),h.qZA(),h.TgZ(3,"button",5),h.NdJ("click",function(){return h.CHM(r),h.oxw().save()}),h._uU(4),h.ALo(5,"translate"),h.qZA()}if(2&e){var n=h.oxw();h.xp6(1),h.Oqu(h.lcZ(2,3,"common.cancel")),h.xp6(2),h.Q6J("disabled",!n.addressForm.valid||!n.addressForm.touched),h.xp6(1),h.hij(" ",h.lcZ(5,5,"common.update")," ")}}var K=function(){function e(t){p(this,e),this.changeDetector=t,this.availableCountries=[]}return g(e,[{key:"ngOnInit",value:function(){var e=this;this.addressForm.valueChanges.subscribe(function(){return e.changeDetector.markForCheck()})}},{key:"cancel",value:function(){this.resolveWith()}},{key:"save",value:function(){this.resolveWith(this.addressForm)}}]),e}();K.\u0275fac=function(e){return new(e||K)(h.Y36(h.sBO))},K.\u0275cmp=h.Xpm({type:K,selectors:[["vdr-address-detail-dialog"]],decls:3,vars:3,consts:[["vdrDialogTitle",""],[3,"formGroup","availableCountries","customFields"],["vdrDialogButtons",""],[4,"ngIf"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(h.YNc(0,X,2,2,"ng-template",0),h._UZ(1,"vdr-address-form",1),h.YNc(2,W,6,7,"ng-template",2)),2&e&&(h.xp6(1),h.Q6J("formGroup",t.addressForm)("availableCountries",t.availableCountries)("customFields",t.customFields))},directives:[y.q,B.C,b.JL,b.sg,M.n,J.O5],pipes:[k.X$],styles:["clr-input-container[_ngcontent-%COMP%]{margin-bottom:12px}"],changeDetection:0});var z=d(99667),ee=d(33146),te=d(74447),re=d(51546),ne=d(30735),oe=d(41519),ie=d(28854),se=d(15111);function ae(e,t){if(1&e&&(h.TgZ(0,"span",13),h._uU(1),h.qZA()),2&e){var r=h.oxw().ngIf;h.xp6(1),h.hij("",r.streetLine1,",")}}function ce(e,t){1&e&&(h.TgZ(0,"vdr-chip",14),h._UZ(1,"clr-icon",15),h._uU(2),h.ALo(3,"translate"),h.qZA()),2&e&&(h.xp6(2),h.hij(" ",h.lcZ(3,1,"customer.default-shipping-address")," "))}function ue(e,t){1&e&&(h.TgZ(0,"vdr-chip",14),h._UZ(1,"clr-icon",16),h._uU(2),h.ALo(3,"translate"),h.qZA()),2&e&&(h.xp6(2),h.hij(" ",h.lcZ(3,1,"customer.default-billing-address")," "))}function le(e,t){if(1&e){var r=h.EpF();h.ynx(0),h.TgZ(1,"button",17),h.NdJ("click",function(){return h.CHM(r),h.oxw(2).editAddress()}),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"vdr-dropdown"),h.TgZ(5,"button",18),h._uU(6),h.ALo(7,"translate"),h._UZ(8,"clr-icon",19),h.qZA(),h.TgZ(9,"vdr-dropdown-menu"),h.TgZ(10,"button",20),h.NdJ("click",function(){return h.CHM(r),h.oxw(2).setAsDefaultShippingAddress()}),h._uU(11),h.ALo(12,"translate"),h.qZA(),h.TgZ(13,"button",20),h.NdJ("click",function(){return h.CHM(r),h.oxw(2).setAsDefaultBillingAddress()}),h._uU(14),h.ALo(15,"translate"),h.qZA(),h._UZ(16,"div",21),h.TgZ(17,"button",22),h.NdJ("click",function(){return h.CHM(r),h.oxw(2).delete()}),h._UZ(18,"clr-icon",23),h._uU(19),h.ALo(20,"translate"),h.qZA(),h.qZA(),h.qZA(),h.BQk()}if(2&e){var n=h.oxw(2);h.xp6(2),h.hij(" ",h.lcZ(3,7,"common.edit")," "),h.xp6(4),h.hij(" ",h.lcZ(7,9,"common.more")," "),h.xp6(4),h.Q6J("disabled",n.isDefaultShipping),h.xp6(1),h.hij(" ",h.lcZ(12,11,"customer.set-as-default-shipping-address")," "),h.xp6(2),h.Q6J("disabled",n.isDefaultBilling),h.xp6(1),h.hij(" ",h.lcZ(15,13,"customer.set-as-default-billing-address")," "),h.xp6(5),h.hij(" ",h.lcZ(20,15,"common.delete")," ")}}function de(e,t){if(1&e&&(h.TgZ(0,"div",1),h.TgZ(1,"div",2),h.TgZ(2,"div",3),h.YNc(3,ae,2,1,"span",4),h._uU(4),h.qZA(),h.TgZ(5,"div",5),h.YNc(6,ce,4,3,"vdr-chip",6),h.YNc(7,ue,4,3,"vdr-chip",6),h.qZA(),h.qZA(),h.TgZ(8,"div",7),h.TgZ(9,"div",8),h._UZ(10,"vdr-formatted-address",9),h.qZA(),h.qZA(),h.TgZ(11,"div",10),h._UZ(12,"vdr-entity-info",11),h.YNc(13,le,21,17,"ng-container",12),h.qZA(),h.qZA()),2&e){var r=t.ngIf,n=h.oxw();h.xp6(3),h.Q6J("ngIf",r.streetLine1),h.xp6(1),h.hij(" ",r.countryCode," "),h.xp6(2),h.Q6J("ngIf",n.isDefaultShipping),h.xp6(1),h.Q6J("ngIf",n.isDefaultBilling),h.xp6(3),h.Q6J("address",r),h.xp6(2),h.Q6J("entity",r),h.xp6(1),h.Q6J("ngIf",n.editable)}}var me=function(){function e(t,r){p(this,e),this.modalService=t,this.changeDetector=r,this.availableCountries=[],this.editable=!0,this.setAsDefaultShipping=new h.vpe,this.setAsDefaultBilling=new h.vpe,this.deleteAddress=new h.vpe,this.dataDependenciesPopulated=new m.X(!1)}return g(e,[{key:"ngOnInit",value:function(){var e=this;this.addressForm.get("streetLine1").value||this.dataDependenciesPopulated.pipe((0,G.h)(function(e){return e}),(0,R.q)(1)).subscribe(function(){e.editAddress()})}},{key:"ngOnChanges",value:function(e){null!=this.customFields&&null!=this.availableCountries&&this.dataDependenciesPopulated.next(!0)}},{key:"getCountryName",value:function(e){if(!this.availableCountries)return"";var t=this.availableCountries.find(function(t){return t.code===e});return t?t.name:""}},{key:"setAsDefaultBillingAddress",value:function(){this.setAsDefaultBilling.emit(this.addressForm.value.id),this.addressForm.markAsDirty()}},{key:"setAsDefaultShippingAddress",value:function(){this.setAsDefaultShipping.emit(this.addressForm.value.id),this.addressForm.markAsDirty()}},{key:"delete",value:function(){this.deleteAddress.emit(this.addressForm.value.id),this.addressForm.markAsDirty()}},{key:"editAddress",value:function(){var e=this;this.modalService.fromComponent(K,{locals:{addressForm:this.addressForm,customFields:this.customFields,availableCountries:this.availableCountries},size:"md",closable:!0}).subscribe(function(){e.changeDetector.markForCheck()})}}]),e}();me.\u0275fac=function(e){return new(e||me)(h.Y36(Z.Z7U),h.Y36(h.sBO))},me.\u0275cmp=h.Xpm({type:me,selectors:[["vdr-address-card"]],inputs:{addressForm:"addressForm",customFields:"customFields",availableCountries:"availableCountries",isDefaultBilling:"isDefaultBilling",isDefaultShipping:"isDefaultShipping",editable:"editable"},outputs:{setAsDefaultShipping:"setAsDefaultShipping",setAsDefaultBilling:"setAsDefaultBilling",deleteAddress:"deleteAddress"},features:[h.TTD],decls:1,vars:1,consts:[["class","card",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"address-title"],["class","street-line",4,"ngIf"],[1,"default-controls"],["class","is-default p8",4,"ngIf"],[1,"card-block"],[1,"card-text"],[3,"address"],[1,"card-footer"],[3,"entity"],[4,"ngIf"],[1,"street-line"],[1,"is-default","p8"],["shape","truck"],["shape","credit-card"],[1,"btn","btn-sm","btn-link",3,"click"],["type","button","vdrDropdownTrigger","",1,"btn","btn-sm","btn-link"],["shape","caret down"],["vdrDropdownItem","",1,"button",3,"disabled","click"],[1,"dropdown-divider"],["type","button","vdrDropdownItem","",1,"delete-button",3,"click"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&h.YNc(0,de,14,7,"div",0),2&e&&h.Q6J("ngIf",t.addressForm.value)},directives:[J.O5,z.b,ee.V,te.Y,re.qvL,ne.J,oe.U,ie.N,se.H],pipes:[k.X$],styles:["[_nghost-%COMP%]{display:block;max-width:360px}clr-input-container[_ngcontent-%COMP%]{margin-bottom:12px}.defaul-controls[_ngcontent-%COMP%]{display:flex}.is-default[_ngcontent-%COMP%]{margin:0;color:var(--color-success-500)}"],changeDetection:0});var pe=d(3786),fe=d(30724),ge=d(87187),ve=d(42720),he=d(30400),Ze=d(8117),ye=d(92597),be=d(89919),Ae=d(85816),xe=d(56816),Ce=d(36868);function Te(e,t){1&e&&(h._uU(0),h.ALo(1,"translate")),2&e&&h.hij(" ",h.lcZ(1,1,"customer.add-customer-to-group"),"\n")}function _e(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"span",5),h.NdJ("click",function(){var e=h.CHM(r),t=e.item;return e.clear(t)}),h._uU(1," \xd7 "),h.qZA(),h.TgZ(2,"vdr-chip",6),h._uU(3),h.qZA()}if(2&e){var n=t.item;h.xp6(2),h.Q6J("colorFrom",n.id),h.xp6(1),h.Oqu(n.name)}}function we(e,t){if(1&e&&(h.TgZ(0,"vdr-chip",6),h._uU(1),h.qZA()),2&e){var r=t.item;h.Q6J("colorFrom",r.id),h.xp6(1),h.Oqu(r.name)}}var qe=function(e){return{count:e}};function Ue(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"button",7),h.NdJ("click",function(){return h.CHM(r),h.oxw().cancel()}),h._uU(1),h.ALo(2,"translate"),h.qZA(),h.TgZ(3,"button",8),h.NdJ("click",function(){return h.CHM(r),h.oxw().add()}),h._uU(4),h.ALo(5,"translate"),h.qZA()}if(2&e){var n=h.oxw();h.xp6(1),h.Oqu(h.lcZ(2,3,"common.cancel")),h.xp6(2),h.Q6J("disabled",!n.selectedGroupIds.length),h.xp6(1),h.hij(" ",h.xi3(5,5,"customer.add-customer-to-groups-with-count",h.VKq(8,qe,n.selectedGroupIds.length))," ")}}var Ne=function(){function e(t){p(this,e),this.dataService=t,this.selectedGroupIds=[]}return g(e,[{key:"ngOnInit",value:function(){this.groups$=this.dataService.customer.getCustomerGroupList().mapStream(function(e){return e.customerGroups.items})}},{key:"cancel",value:function(){this.resolveWith()}},{key:"add",value:function(){this.resolveWith(this.selectedGroupIds)}}]),e}();Ne.\u0275fac=function(e){return new(e||Ne)(h.Y36(Z.DoR))},Ne.\u0275cmp=h.Xpm({type:Ne,selectors:[["vdr-select-customer-group-dialog"]],decls:6,vars:8,consts:[["vdrDialogTitle",""],["appendTo","body","bindValue","id",3,"items","addTag","multiple","ngModel","clearable","searchable","ngModelChange"],["ng-label-tmp",""],["ng-option-tmp",""],["vdrDialogButtons",""],["aria-hidden","true",1,"ng-value-icon","left",3,"click"],[3,"colorFrom"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(h.YNc(0,Te,2,3,"ng-template",0),h.TgZ(1,"ng-select",1),h.NdJ("ngModelChange",function(e){return t.selectedGroupIds=e}),h.ALo(2,"async"),h.YNc(3,_e,4,2,"ng-template",2),h.YNc(4,we,2,2,"ng-template",3),h.qZA(),h.YNc(5,Ue,6,10,"ng-template",4)),2&e&&(h.xp6(1),h.Q6J("items",h.lcZ(2,6,t.groups$))("addTag",!1)("multiple",!0)("ngModel",t.selectedGroupIds)("clearable",!0)("searchable",!1))},directives:[y.q,Ce.w9,b.JJ,b.On,Ce.bb,Ce.Z2,M.n,te.Y],pipes:[J.Ov,k.X$],styles:[""],changeDetection:0});var Oe=d(27346);function Se(e,t){1&e&&(h.ynx(0),h._UZ(1,"clr-icon",1),h._uU(2),h.ALo(3,"translate"),h.BQk()),2&e&&(h.xp6(2),h.hij(" ",h.lcZ(3,1,"customer.verified")," "))}function Ie(e,t){1&e&&(h.ynx(0),h._UZ(1,"clr-icon",2),h._uU(2),h.ALo(3,"translate"),h.BQk()),2&e&&(h.xp6(2),h.hij(" ",h.lcZ(3,1,"customer.registered")," "))}function ke(e,t){if(1&e&&(h.TgZ(0,"vdr-chip"),h.YNc(1,Se,4,3,"ng-container",0),h.YNc(2,Ie,4,3,"ng-container",0),h.qZA()),2&e){var r=h.oxw();h.xp6(1),h.Q6J("ngIf",null==r.customer.user?null:r.customer.user.verified),h.xp6(1),h.Q6J("ngIf",!(null!=r.customer.user&&r.customer.user.verified))}}function Je(e,t){1&e&&(h.TgZ(0,"vdr-chip"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"customer.guest")))}var Fe=function e(){p(this,e)};Fe.\u0275fac=function(e){return new(e||Fe)},Fe.\u0275cmp=h.Xpm({type:Fe,selectors:[["vdr-customer-status-label"]],inputs:{customer:"customer"},decls:2,vars:2,consts:[[4,"ngIf"],["shape","check-circle",1,"verified-user-icon"],["shape","check-circle",1,"registered-user-icon"]],template:function(e,t){1&e&&(h.YNc(0,ke,3,2,"vdr-chip",0),h.YNc(1,Je,3,3,"vdr-chip",0)),2&e&&(h.Q6J("ngIf",null==t.customer.user?null:t.customer.user.id),h.xp6(1),h.Q6J("ngIf",!(null!=t.customer.user&&t.customer.user.id)))},directives:[J.O5,te.Y,re.qvL],pipes:[k.X$],styles:[".registered-user-icon[_ngcontent-%COMP%]{color:var(--color-grey-300)}.verified-user-icon[_ngcontent-%COMP%]{color:var(--color-success-500)}"],changeDetection:0});var Le=d(38276),De=d(34652),Pe=d(82505),Me=d(59416),Ee=d(50837),Qe=d(82355),$e=d(64664),Ye=d(2702),je=d(87368);function Ge(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"vdr-timeline-entry",4),h.TgZ(1,"div",5),h.TgZ(2,"textarea",6),h.NdJ("ngModelChange",function(e){return h.CHM(r),h.oxw().note=e}),h.qZA(),h.TgZ(3,"button",7),h.NdJ("click",function(){return h.CHM(r),h.oxw().addNoteToCustomer()}),h._uU(4),h.ALo(5,"translate"),h.qZA(),h.qZA(),h.qZA()}if(2&e){var n=h.oxw();h.xp6(2),h.Q6J("ngModel",n.note),h.xp6(1),h.Q6J("disabled",!n.note),h.xp6(1),h.hij(" ",h.lcZ(5,3,"order.add-note")," ")}}function Re(e,t){1&e&&(h.ynx(0),h._uU(1),h.ALo(2,"translate"),h.BQk()),2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"customer.history-using-native-auth-strategy")," "))}var Be=function(e){return{strategy:e}};function He(e,t){if(1&e&&(h._uU(0),h.ALo(1,"translate")),2&e){var r=h.oxw(2).$implicit;h.hij(" ",h.xi3(1,1,"customer.history-using-external-auth-strategy",h.VKq(4,Be,r.data.strategy))," ")}}function Ve(e,t){if(1&e&&(h.ynx(0),h.TgZ(1,"div",11),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.YNc(4,Re,3,3,"ng-container",12),h.YNc(5,He,2,6,"ng-template",null,13,h.W1O),h.BQk()),2&e){var r=h.MAs(6),n=h.oxw().$implicit;h.xp6(2),h.hij(" ",h.lcZ(3,3,"customer.history-customer-registered")," "),h.xp6(2),h.Q6J("ngIf","native"===n.data.strategy)("ngIfElse",r)}}function Xe(e,t){1&e&&(h.ynx(0),h._uU(1),h.ALo(2,"translate"),h.BQk()),2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"customer.history-using-native-auth-strategy")," "))}function We(e,t){if(1&e&&(h._uU(0),h.ALo(1,"translate")),2&e){var r=h.oxw(2).$implicit;h.hij(" ",h.xi3(1,1,"customer.history-using-external-auth-strategy",h.VKq(4,Be,r.data.strategy))," ")}}function Ke(e,t){if(1&e&&(h.ynx(0),h.TgZ(1,"div",11),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.YNc(4,Xe,3,3,"ng-container",12),h.YNc(5,We,2,6,"ng-template",null,13,h.W1O),h.BQk()),2&e){var r=h.MAs(6),n=h.oxw().$implicit;h.xp6(2),h.hij(" ",h.lcZ(3,3,"customer.history-customer-verified")," "),h.xp6(2),h.Q6J("ngIf","native"===n.data.strategy)("ngIfElse",r)}}function ze(e,t){if(1&e&&(h.ynx(0),h.TgZ(1,"div",14),h._uU(2),h.ALo(3,"translate"),h.TgZ(4,"vdr-history-entry-detail"),h._UZ(5,"vdr-object-tree",15),h.qZA(),h.qZA(),h.BQk()),2&e){var r=h.oxw().$implicit;h.xp6(2),h.hij(" ",h.lcZ(3,2,"customer.history-customer-detail-updated")," "),h.xp6(3),h.Q6J("value",r.data.input)}}var et=function(e){return{groupName:e}};function tt(e,t){if(1&e&&(h.ynx(0),h._uU(1),h.ALo(2,"translate"),h.BQk()),2&e){var r=h.oxw().$implicit;h.xp6(1),h.hij(" ",h.xi3(2,1,"customer.history-customer-added-to-group",h.VKq(4,et,r.data.groupName))," ")}}function rt(e,t){if(1&e&&(h.ynx(0),h._uU(1),h.ALo(2,"translate"),h.BQk()),2&e){var r=h.oxw().$implicit;h.xp6(1),h.hij(" ",h.xi3(2,1,"customer.history-customer-removed-from-group",h.VKq(4,et,r.data.groupName))," ")}}function nt(e,t){if(1&e&&(h.ynx(0),h._uU(1),h.ALo(2,"translate"),h.TgZ(3,"div",14),h.TgZ(4,"div",16),h._uU(5),h.qZA(),h.qZA(),h.BQk()),2&e){var r=h.oxw().$implicit;h.xp6(1),h.hij(" ",h.lcZ(2,2,"customer.history-customer-address-created")," "),h.xp6(4),h.Oqu(r.data.address)}}function ot(e,t){if(1&e&&(h.ynx(0),h._uU(1),h.ALo(2,"translate"),h.TgZ(3,"div",14),h.TgZ(4,"div",16),h._uU(5),h.qZA(),h.TgZ(6,"vdr-history-entry-detail"),h._UZ(7,"vdr-object-tree",15),h.qZA(),h.qZA(),h.BQk()),2&e){var r=h.oxw().$implicit;h.xp6(1),h.hij(" ",h.lcZ(2,3,"customer.history-customer-address-updated")," "),h.xp6(4),h.Oqu(r.data.address),h.xp6(2),h.Q6J("value",r.data.input)}}function it(e,t){if(1&e&&(h.ynx(0),h._uU(1),h.ALo(2,"translate"),h.TgZ(3,"div",16),h._uU(4),h.qZA(),h.BQk()),2&e){var r=h.oxw().$implicit;h.xp6(1),h.hij(" ",h.lcZ(2,2,"customer.history-customer-address-deleted")," "),h.xp6(3),h.Oqu(r.data.address)}}function st(e,t){1&e&&(h.ynx(0),h._uU(1),h.ALo(2,"translate"),h.BQk()),2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"customer.history-customer-password-updated")," "))}function at(e,t){1&e&&(h.ynx(0),h._uU(1),h.ALo(2,"translate"),h.BQk()),2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"customer.history-customer-password-reset-requested")," "))}function ct(e,t){1&e&&(h.ynx(0),h._uU(1),h.ALo(2,"translate"),h.BQk()),2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"customer.history-customer-password-reset-verified")," "))}function ut(e,t){if(1&e&&(h.ynx(0),h.TgZ(1,"div",14),h._uU(2),h.ALo(3,"translate"),h.TgZ(4,"vdr-history-entry-detail"),h.TgZ(5,"vdr-labeled-data",17),h.ALo(6,"translate"),h._uU(7),h.qZA(),h.TgZ(8,"vdr-labeled-data",17),h.ALo(9,"translate"),h._uU(10),h.qZA(),h.qZA(),h.qZA(),h.BQk()),2&e){var r=h.oxw().$implicit;h.xp6(2),h.hij(" ",h.lcZ(3,5,"customer.history-customer-email-update-requested")," "),h.xp6(3),h.Q6J("label",h.lcZ(6,7,"customer.old-email-address")),h.xp6(2),h.Oqu(r.data.oldEmailAddress),h.xp6(1),h.Q6J("label",h.lcZ(9,9,"customer.new-email-address")),h.xp6(2),h.Oqu(r.data.newEmailAddress)}}function lt(e,t){if(1&e&&(h.ynx(0),h.TgZ(1,"div",14),h._uU(2),h.ALo(3,"translate"),h.TgZ(4,"vdr-history-entry-detail"),h.TgZ(5,"vdr-labeled-data",17),h.ALo(6,"translate"),h._uU(7),h.qZA(),h.TgZ(8,"vdr-labeled-data",17),h.ALo(9,"translate"),h._uU(10),h.qZA(),h.qZA(),h.qZA(),h.BQk()),2&e){var r=h.oxw().$implicit;h.xp6(2),h.hij(" ",h.lcZ(3,5,"customer.history-customer-email-update-verified")," "),h.xp6(3),h.Q6J("label",h.lcZ(6,7,"customer.old-email-address")),h.xp6(2),h.Oqu(r.data.oldEmailAddress),h.xp6(1),h.Q6J("label",h.lcZ(9,9,"customer.new-email-address")),h.xp6(2),h.Oqu(r.data.newEmailAddress)}}function dt(e,t){if(1&e){var r=h.EpF();h.ynx(0),h.TgZ(1,"div",14),h.TgZ(2,"div",18),h._uU(3),h.qZA(),h._UZ(4,"div",19),h.TgZ(5,"vdr-dropdown"),h.TgZ(6,"button",20),h._UZ(7,"clr-icon",21),h.qZA(),h.TgZ(8,"vdr-dropdown-menu",22),h.TgZ(9,"button",23),h.NdJ("click",function(){h.CHM(r);var e=h.oxw().$implicit;return h.oxw().updateNote.emit(e)}),h.ALo(10,"hasPermission"),h._UZ(11,"clr-icon",24),h._uU(12),h.ALo(13,"translate"),h.qZA(),h._UZ(14,"div",25),h.TgZ(15,"button",23),h.NdJ("click",function(){h.CHM(r);var e=h.oxw().$implicit;return h.oxw().deleteNote.emit(e)}),h.ALo(16,"hasPermission"),h._UZ(17,"clr-icon",26),h._uU(18),h.ALo(19,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.BQk()}if(2&e){var n=h.oxw().$implicit;h.xp6(3),h.hij(" ",n.data.note," "),h.xp6(6),h.Q6J("disabled",!h.lcZ(10,5,"UpdateCustomer")),h.xp6(3),h.hij(" ",h.lcZ(13,7,"common.edit")," "),h.xp6(3),h.Q6J("disabled",!h.lcZ(16,9,"UpdateCustomer")),h.xp6(3),h.hij(" ",h.lcZ(19,11,"common.delete")," ")}}function mt(e,t){if(1&e&&(h.TgZ(0,"vdr-timeline-entry",8),h.ynx(1,9),h.YNc(2,Ve,7,5,"ng-container",10),h.YNc(3,Ke,7,5,"ng-container",10),h.YNc(4,ze,6,4,"ng-container",10),h.YNc(5,tt,3,6,"ng-container",10),h.YNc(6,rt,3,6,"ng-container",10),h.YNc(7,nt,6,4,"ng-container",10),h.YNc(8,ot,8,5,"ng-container",10),h.YNc(9,it,5,4,"ng-container",10),h.YNc(10,st,3,3,"ng-container",10),h.YNc(11,at,3,3,"ng-container",10),h.YNc(12,ct,3,3,"ng-container",10),h.YNc(13,ut,11,11,"ng-container",10),h.YNc(14,lt,11,11,"ng-container",10),h.YNc(15,dt,20,13,"ng-container",10),h.BQk(),h.qZA()),2&e){var r=t.$implicit,n=h.oxw();h.Q6J("displayType",n.getDisplayType(r))("iconShape",n.getTimelineIcon(r))("createdAt",r.createdAt)("name",n.getName(r))("featured",n.isFeatured(r)),h.xp6(1),h.Q6J("ngSwitch",r.type),h.xp6(1),h.Q6J("ngSwitchCase",n.type.CUSTOMER_REGISTERED),h.xp6(1),h.Q6J("ngSwitchCase",n.type.CUSTOMER_VERIFIED),h.xp6(1),h.Q6J("ngSwitchCase",n.type.CUSTOMER_DETAIL_UPDATED),h.xp6(1),h.Q6J("ngSwitchCase",n.type.CUSTOMER_ADDED_TO_GROUP),h.xp6(1),h.Q6J("ngSwitchCase",n.type.CUSTOMER_REMOVED_FROM_GROUP),h.xp6(1),h.Q6J("ngSwitchCase",n.type.CUSTOMER_ADDRESS_CREATED),h.xp6(1),h.Q6J("ngSwitchCase",n.type.CUSTOMER_ADDRESS_UPDATED),h.xp6(1),h.Q6J("ngSwitchCase",n.type.CUSTOMER_ADDRESS_DELETED),h.xp6(1),h.Q6J("ngSwitchCase",n.type.CUSTOMER_PASSWORD_UPDATED),h.xp6(1),h.Q6J("ngSwitchCase",n.type.CUSTOMER_PASSWORD_RESET_REQUESTED),h.xp6(1),h.Q6J("ngSwitchCase",n.type.CUSTOMER_PASSWORD_RESET_VERIFIED),h.xp6(1),h.Q6J("ngSwitchCase",n.type.CUSTOMER_EMAIL_UPDATE_REQUESTED),h.xp6(1),h.Q6J("ngSwitchCase",n.type.CUSTOMER_EMAIL_UPDATE_VERIFIED),h.xp6(1),h.Q6J("ngSwitchCase",n.type.CUSTOMER_NOTE)}}var pt=function(){function e(){p(this,e),this.addNote=new h.vpe,this.updateNote=new h.vpe,this.deleteNote=new h.vpe,this.note="",this.type=Z.iYD}return g(e,[{key:"getDisplayType",value:function(e){switch(e.type){case Z.iYD.CUSTOMER_VERIFIED:case Z.iYD.CUSTOMER_EMAIL_UPDATE_VERIFIED:case Z.iYD.CUSTOMER_PASSWORD_RESET_VERIFIED:return"success";case Z.iYD.CUSTOMER_REGISTERED:return"muted";case Z.iYD.CUSTOMER_REMOVED_FROM_GROUP:return"error";default:return"default"}}},{key:"getTimelineIcon",value:function(e){switch(e.type){case Z.iYD.CUSTOMER_REGISTERED:return"user";case Z.iYD.CUSTOMER_VERIFIED:return["assign-user","is-solid"];case Z.iYD.CUSTOMER_NOTE:return"note";case Z.iYD.CUSTOMER_ADDED_TO_GROUP:case Z.iYD.CUSTOMER_REMOVED_FROM_GROUP:return"users"}}},{key:"isFeatured",value:function(e){switch(e.type){case Z.iYD.CUSTOMER_REGISTERED:case Z.iYD.CUSTOMER_VERIFIED:return!0;default:return!1}}},{key:"getName",value:function(e){var t=e.administrator;return t?"".concat(t.firstName," ").concat(t.lastName):"".concat(this.customer.firstName," ").concat(this.customer.lastName)}},{key:"addNoteToCustomer",value:function(){this.addNote.emit({note:this.note}),this.note=""}}]),e}();pt.\u0275fac=function(e){return new(e||pt)},pt.\u0275cmp=h.Xpm({type:pt,selectors:[["vdr-customer-history"]],inputs:{customer:"customer",history:"history"},outputs:{addNote:"addNote",updateNote:"updateNote",deleteNote:"deleteNote"},decls:7,vars:6,consts:[[1,"entry-list"],["iconShape","note","displayType","muted",4,"vdrIfPermissions"],[3,"displayType","iconShape","createdAt","name","featured",4,"ngFor","ngForOf"],[3,"isLast"],["iconShape","note","displayType","muted"],[1,"note-entry"],["name","note",1,"note",3,"ngModel","ngModelChange"],[1,"btn","btn-secondary",3,"disabled","click"],[3,"displayType","iconShape","createdAt","name","featured"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"title"],[4,"ngIf","ngIfElse"],["namedStrategy",""],[1,"flex"],[3,"value"],[1,"address-string"],[3,"label"],[1,"note-text"],[1,"flex-spacer"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["vdrDropdownItem","",1,"button",3,"disabled","click"],["shape","edit"],[1,"dropdown-divider"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(h.TgZ(0,"h4"),h._uU(1),h.ALo(2,"translate"),h.qZA(),h.TgZ(3,"div",0),h.YNc(4,Ge,6,5,"vdr-timeline-entry",1),h.YNc(5,mt,16,20,"vdr-timeline-entry",2),h._UZ(6,"vdr-timeline-entry",3),h.qZA()),2&e&&(h.xp6(1),h.Oqu(h.lcZ(2,4,"customer.customer-history")),h.xp6(3),h.Q6J("vdrIfPermissions","UpdateCustomer"),h.xp6(1),h.Q6J("ngForOf",t.history),h.xp6(1),h.Q6J("isLast",!0))},directives:[Me.H,J.sg,Qe._,N.y,b.Fj,b.JJ,b.On,J.RF,J.n9,J.O5,$e.C,Ye._,je.W,ne.J,oe.U,re.qvL,ie.N,se.H],pipes:[k.X$,F.j],styles:[".entry-list[_ngcontent-%COMP%]{margin-top:24px;margin-left:24px;margin-right:12px}.note-entry[_ngcontent-%COMP%]{display:flex;align-items:center}.note-entry[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{flex:1}.note-entry[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}textarea.note[_ngcontent-%COMP%]{flex:1;height:36px;border-radius:3px;margin-right:6px}.note-text[_ngcontent-%COMP%]{color:var(--color-text-100);white-space:pre-wrap}.address-string[_ngcontent-%COMP%]{font-size:smaller;color:var(--color-text-200)}"],changeDetection:0});var ft=d(2651),gt=d(66826),vt=d(4187);function ht(e,t){if(1&e&&(h.TgZ(0,"div",23),h.ALo(1,"localeDate"),h._uU(2),h.ALo(3,"translate"),h.ALo(4,"timeAgo"),h.qZA()),2&e){var r=t.ngIf;h.Q6J("title",h.xi3(1,3,r,"medium")),h.xp6(2),h.AsE(" ",h.lcZ(3,6,"customer.last-login"),": ",h.lcZ(4,8,r)," ")}}function Zt(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"button",24),h.NdJ("click",function(){return h.CHM(r),h.oxw().create()}),h._uU(1),h.ALo(2,"translate"),h.qZA()}if(2&e){var n=h.oxw();h.Q6J("disabled",!(n.addressDefaultsUpdated||n.detailForm.valid&&n.detailForm.dirty)),h.xp6(1),h.hij(" ",h.lcZ(2,2,"common.create")," ")}}function yt(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"button",24),h.NdJ("click",function(){return h.CHM(r),h.oxw(2).save()}),h._uU(1),h.ALo(2,"translate"),h.qZA()}if(2&e){var n=h.oxw(2);h.Q6J("disabled",!(n.addressDefaultsUpdated||n.detailForm.valid&&n.detailForm.dirty)),h.xp6(1),h.hij(" ",h.lcZ(2,2,"common.update")," ")}}function bt(e,t){1&e&&h.YNc(0,yt,3,4,"button",25),2&e&&h.Q6J("vdrIfPermissions","UpdateCustomer")}function At(e,t){1&e&&(h.TgZ(0,"vdr-form-field",26),h.ALo(1,"translate"),h._UZ(2,"input",27),h.qZA()),2&e&&h.Q6J("label",h.lcZ(1,1,"customer.password"))}var xt=function(){return["customer","customFields"]};function Ct(e,t){if(1&e&&(h.TgZ(0,"section",28),h.TgZ(1,"label"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h._UZ(4,"vdr-tabbed-custom-fields",29),h.qZA()),2&e){var r=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,3,"common.custom-fields")),h.xp6(2),h.Q6J("customFields",r.customFields)("customFieldsFormGroup",r.detailForm.get(h.DdM(5,xt)))}}function Tt(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"vdr-chip",36),h.NdJ("iconClick",function(){var e=h.CHM(r).$implicit;return h.oxw(3).removeFromGroup(e)}),h._uU(1),h.qZA()}if(2&e){var n=t.$implicit;h.Q6J("colorFrom",n.id),h.xp6(1),h.Oqu(n.name)}}function _t(e,t){if(1&e&&(h.ynx(0),h.YNc(1,Tt,2,2,"vdr-chip",35),h.BQk()),2&e){var r=h.oxw().ngIf;h.xp6(1),h.Q6J("ngForOf",r)}}function wt(e,t){1&e&&(h._uU(0),h.ALo(1,"translate")),2&e&&h.hij(" ",h.lcZ(1,1,"customer.not-a-member-of-any-groups")," ")}function qt(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"button",37),h.NdJ("click",function(){return h.CHM(r),h.oxw(2).addToGroup()}),h._UZ(1,"clr-icon",38),h._uU(2),h.ALo(3,"translate"),h.qZA()}2&e&&(h.xp6(2),h.hij(" ",h.lcZ(3,1,"customer.add-customer-to-group")," "))}function Ut(e,t){if(1&e&&(h.TgZ(0,"div",30),h.TgZ(1,"label",31),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.YNc(4,_t,2,1,"ng-container",32),h.YNc(5,wt,2,3,"ng-template",null,33,h.W1O),h.TgZ(7,"div"),h.YNc(8,qt,4,3,"button",34),h.qZA(),h.qZA()),2&e){var r=t.ngIf,n=h.MAs(6);h.xp6(2),h.Oqu(h.lcZ(3,4,"customer.customer-groups")),h.xp6(2),h.Q6J("ngIf",r.length)("ngIfElse",n),h.xp6(4),h.Q6J("vdrIfPermissions","UpdateCustomerGroup")}}var Nt=function(){return["UpdateCustomer"]};function Ot(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"vdr-address-card",45),h.NdJ("setAsDefaultBilling",function(e){return h.CHM(r),h.oxw(2).setDefaultBillingAddressId(e)})("setAsDefaultShipping",function(e){return h.CHM(r),h.oxw(2).setDefaultShippingAddressId(e)})("deleteAddress",function(e){return h.CHM(r),h.oxw(2).toggleDeleteAddress(e)}),h.ALo(1,"async"),h.ALo(2,"hasPermission"),h.qZA()}if(2&e){var n=t.$implicit,o=h.oxw(2);h.ekj("to-delete",o.addressesToDeleteIds.has(n.value.id)),h.Q6J("availableCountries",h.lcZ(1,8,o.availableCountries$))("isDefaultBilling",o.defaultBillingAddressId===n.value.id)("isDefaultShipping",o.defaultShippingAddressId===n.value.id)("addressForm",n)("customFields",o.addressCustomFields)("editable",h.lcZ(2,10,h.DdM(12,Nt))&&!o.addressesToDeleteIds.has(n.value.id))}}function St(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"button",46),h.NdJ("click",function(){return h.CHM(r),h.oxw(2).addAddress()}),h._UZ(1,"clr-icon",38),h._uU(2),h.ALo(3,"translate"),h.qZA()}2&e&&(h.xp6(2),h.hij(" ",h.lcZ(3,1,"customer.create-new-address")," "))}var It=function(e){return["/orders/",e]};function kt(e,t){if(1&e&&(h.TgZ(0,"td",47),h._uU(1),h.qZA(),h.TgZ(2,"td",47),h._uU(3),h.qZA(),h.TgZ(4,"td",47),h._uU(5),h.ALo(6,"localeCurrency"),h.qZA(),h.TgZ(7,"td",47),h._uU(8),h.ALo(9,"localeDate"),h.qZA(),h.TgZ(10,"td",48),h._UZ(11,"vdr-table-row-action",49),h.ALo(12,"translate"),h.qZA()),2&e){var r=t.item;h.xp6(1),h.Oqu(r.code),h.xp6(2),h.Oqu(r.state),h.xp6(2),h.Oqu(h.xi3(6,6,r.totalWithTax,r.currencyCode)),h.xp6(3),h.Oqu(h.xi3(9,9,r.updatedAt,"medium")),h.xp6(3),h.Q6J("label",h.lcZ(12,12,"common.open"))("linkTo",h.VKq(14,It,r.id))}}function Jt(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"div",39),h.TgZ(1,"div",40),h.TgZ(2,"h3"),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.YNc(5,Ot,3,13,"vdr-address-card",41),h.YNc(6,St,4,3,"button",42),h.qZA(),h.TgZ(7,"div",43),h.TgZ(8,"h3"),h._uU(9),h.ALo(10,"translate"),h.qZA(),h.TgZ(11,"vdr-data-table",44),h.NdJ("itemsPerPageChange",function(e){return h.CHM(r),h.oxw().setOrderItemsPerPage(e)})("pageChange",function(e){return h.CHM(r),h.oxw().setOrderCurrentPage(e)}),h.ALo(12,"async"),h.ALo(13,"async"),h.ALo(14,"translate"),h.TgZ(15,"vdr-dt-column"),h._uU(16),h.ALo(17,"translate"),h.qZA(),h.TgZ(18,"vdr-dt-column"),h._uU(19),h.ALo(20,"translate"),h.qZA(),h.TgZ(21,"vdr-dt-column"),h._uU(22),h.ALo(23,"translate"),h.qZA(),h.TgZ(24,"vdr-dt-column"),h._uU(25),h.ALo(26,"translate"),h.qZA(),h._UZ(27,"vdr-dt-column"),h.YNc(28,kt,13,16,"ng-template"),h.qZA(),h.qZA(),h.qZA()}if(2&e){var n=h.oxw();h.xp6(3),h.Oqu(h.lcZ(4,13,"customer.addresses")),h.xp6(2),h.Q6J("ngForOf",n.getAddressFormControls()),h.xp6(1),h.Q6J("vdrIfPermissions","UpdateCustomer"),h.xp6(3),h.Oqu(h.lcZ(10,15,"customer.orders")),h.xp6(2),h.Q6J("items",h.lcZ(12,17,n.orders$))("itemsPerPage",n.ordersPerPage)("totalItems",h.lcZ(13,19,n.ordersCount$))("currentPage",n.currentOrdersPage)("emptyStateLabel",h.lcZ(14,21,"customer.no-orders-placed")),h.xp6(5),h.Oqu(h.lcZ(17,23,"common.code")),h.xp6(3),h.Oqu(h.lcZ(20,25,"order.state")),h.xp6(3),h.Oqu(h.lcZ(23,27,"order.total")),h.xp6(3),h.Oqu(h.lcZ(26,29,"common.updated-at"))}}function Ft(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"div",39),h.TgZ(1,"div",50),h.TgZ(2,"vdr-customer-history",51),h.NdJ("addNote",function(e){return h.CHM(r),h.oxw().addNoteToCustomer(e)})("updateNote",function(e){return h.CHM(r),h.oxw().updateNote(e)})("deleteNote",function(e){return h.CHM(r),h.oxw().deleteNote(e)}),h.ALo(3,"async"),h.ALo(4,"async"),h.qZA(),h.qZA(),h.qZA()}if(2&e){var n=h.oxw();h.xp6(2),h.Q6J("customer",h.lcZ(3,2,n.entity$))("history",h.lcZ(4,4,n.history$))}}var Lt=function(e){r(i,e);var n=o(i);function i(e,t,r,o,s,a,c,l){var d;return p(this,i),(d=n.call(this,e,t,r,a)).changeDetector=o,d.formBuilder=s,d.dataService=a,d.modalService=c,d.notificationService=l,d.fetchHistory=new A.xQ,d.addressesToDeleteIds=new Set,d.addressDefaultsUpdated=!1,d.ordersPerPage=10,d.currentOrdersPage=1,d.orderListUpdates$=new A.xQ,d.customFields=d.getCustomFieldConfig("Customer"),d.addressCustomFields=d.getCustomFieldConfig("Address"),d.detailForm=d.formBuilder.group({customer:d.formBuilder.group({title:"",firstName:["",b.kI.required],lastName:["",b.kI.required],phoneNumber:"",emailAddress:["",[b.kI.required,b.kI.email]],password:"",customFields:d.formBuilder.group(d.customFields.reduce(function(e,t){return Object.assign(Object.assign({},e),u({},t.name,""))},{}))}),addresses:new b.Oe([])}),d}return g(i,[{key:"ngOnInit",value:function(){var e=this;this.init(),this.availableCountries$=this.dataService.settings.getAvailableCountries().mapSingle(function(e){return e.countries.items}).pipe((0,ye.d)(1));var t=this.entity$.pipe(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return e.lift.call(be.T.apply(void 0,[e].concat(t)))}}(this.orderListUpdates$));this.orders$=t.pipe((0,v.U)(function(e){return e.orders.items})),this.ordersCount$=this.entity$.pipe((0,v.U)(function(e){return e.orders.totalItems})),this.history$=this.fetchHistory.pipe((0,C.O)(null),(0,f.w)(function(){return e.dataService.customer.getCustomerHistory(e.id,{sort:{createdAt:Z.Asd.DESC}}).mapStream(function(e){var t;return null===(t=e.customer)||void 0===t?void 0:t.history.items})}))}},{key:"ngOnDestroy",value:function(){this.destroy(),this.orderListUpdates$.complete()}},{key:"getAddressFormControls",value:function(){return this.detailForm.get(["addresses"]).controls}},{key:"setDefaultBillingAddressId",value:function(e){this.defaultBillingAddressId=e,this.addressDefaultsUpdated=!0}},{key:"setDefaultShippingAddressId",value:function(e){this.defaultShippingAddressId=e,this.addressDefaultsUpdated=!0}},{key:"toggleDeleteAddress",value:function(e){this.addressesToDeleteIds.has(e)?this.addressesToDeleteIds.delete(e):this.addressesToDeleteIds.add(e)}},{key:"addAddress",value:function(){var e=this.detailForm.get("addresses"),r=this.formBuilder.group({fullName:"",company:"",streetLine1:["",b.kI.required],streetLine2:"",city:"",province:"",postalCode:"",countryCode:["",b.kI.required],phoneNumber:"",defaultShippingAddress:!1,defaultBillingAddress:!1});if(this.addressCustomFields.length){var n,o=this.formBuilder.group({}),i=t(this.addressCustomFields);try{for(i.s();!(n=i.n()).done;){var s=n.value;o.addControl(s.name,new b.NI(""))}}catch(a){i.e(a)}finally{i.f()}r.addControl("customFields",o)}e.push(r)}},{key:"setOrderItemsPerPage",value:function(e){this.ordersPerPage=+e,this.fetchOrdersList()}},{key:"setOrderCurrentPage",value:function(e){this.currentOrdersPage=+e,this.fetchOrdersList()}},{key:"create",value:function(){var e,t=this,r=this.detailForm.get("customer");if(r){var n=r.value,o=null===(e=r.get("customFields"))||void 0===e?void 0:e.value,i={title:n.title,emailAddress:n.emailAddress,firstName:n.firstName,lastName:n.lastName,phoneNumber:n.phoneNumber,customFields:o};this.dataService.customer.createCustomer(i,n.password).subscribe(function(e){var r=e.createCustomer;switch(r.__typename){case"Customer":t.notificationService.success((0,fe.J)("common.notify-create-success"),{entity:"Customer"}),r.emailAddress&&!n.password&&t.notificationService.notify({message:(0,fe.J)("customer.email-verification-sent"),translationVars:{emailAddress:n.emailAddress},type:"info",duration:1e4}),t.detailForm.markAsPristine(),t.addressDefaultsUpdated=!1,t.changeDetector.markForCheck(),t.router.navigate(["../",r.id],{relativeTo:t.route});break;case"EmailAddressConflictError":t.notificationService.error(r.message)}})}}},{key:"save",value:function(){var e=this;this.entity$.pipe((0,R.q)(1),(0,Ae.zg)(function(r){var n,o=r.id,i=[],s=e.detailForm.get("customer");if(s&&s.dirty){var a=s.value,c=null===(n=s.get("customFields"))||void 0===n?void 0:n.value,u={id:o,title:a.title,emailAddress:a.emailAddress,firstName:a.firstName,lastName:a.lastName,phoneNumber:a.phoneNumber,customFields:c};i.push(e.dataService.customer.updateCustomer(u).pipe((0,v.U)(function(e){return e.updateCustomer})))}var l=e.detailForm.get("addresses");if(l&&l.dirty||e.addressDefaultsUpdated){var d,m=t(l.controls);try{for(m.s();!(d=m.n()).done;){var p=d.value;if(p.dirty||e.addressDefaultsUpdated){var f=p.value,g={fullName:f.fullName,company:f.company,streetLine1:f.streetLine1,streetLine2:f.streetLine2,city:f.city,province:f.province,postalCode:f.postalCode,countryCode:f.countryCode,phoneNumber:f.phoneNumber,defaultShippingAddress:e.defaultShippingAddressId===f.id,defaultBillingAddress:e.defaultBillingAddressId===f.id,customFields:f.customFields};f.id?e.addressesToDeleteIds.has(f.id)?i.push(e.dataService.customer.deleteCustomerAddress(f.id).pipe((0,v.U)(function(e){return e.deleteCustomerAddress}))):i.push(e.dataService.customer.updateCustomerAddress(Object.assign(Object.assign({},g),{id:f.id})).pipe((0,v.U)(function(e){return e.updateCustomerAddress}))):i.push(e.dataService.customer.createCustomerAddress(o,g).pipe((0,v.U)(function(e){return e.createCustomerAddress})))}}}catch(h){m.e(h)}finally{m.f()}}return(0,ve.D)(i)})).subscribe(function(r){var n,o=!1,i=t(r);try{for(i.s();!(n=i.n()).done;){var s=n.value;switch(s.__typename){case"Customer":case"Address":case"Success":o||(e.notificationService.success((0,fe.J)("common.notify-update-success"),{entity:"Customer"}),o=!0,e.detailForm.markAsPristine(),e.addressDefaultsUpdated=!1,e.changeDetector.markForCheck(),e.fetchHistory.next(),e.dataService.customer.getCustomer(e.id).single$.subscribe());break;case"EmailAddressConflictError":e.notificationService.error(s.message)}}}catch(a){i.e(a)}finally{i.f()}},function(t){e.notificationService.error((0,fe.J)("common.notify-update-error"),{entity:"Customer"})})}},{key:"addToGroup",value:function(){var e=this;this.modalService.fromComponent(Ne,{size:"md"}).pipe((0,f.w)(function(e){return e?(0,he.D)(e):Ze.E}),(0,xe.b)(function(t){return e.dataService.customer.addCustomersToGroup(t,[e.id])})).subscribe({next:function(t){e.notificationService.success((0,fe.J)("customer.add-customers-to-group-success"),{customerCount:1,groupName:t.addCustomersToGroup.name})},complete:function(){e.dataService.customer.getCustomer(e.id,{take:0}).single$.subscribe(),e.fetchHistory.next()}})}},{key:"removeFromGroup",value:function(e){var t=this;this.modalService.dialog({title:(0,fe.J)("customer.confirm-remove-customer-from-group"),buttons:[{type:"secondary",label:(0,fe.J)("common.cancel")},{type:"danger",label:(0,fe.J)("common.delete"),returnValue:!0}]}).pipe((0,f.w)(function(r){return r?t.dataService.customer.removeCustomersFromGroup(e.id,[t.id]):Ze.E}),(0,f.w)(function(){return t.dataService.customer.getCustomer(t.id,{take:0}).single$})).subscribe(function(r){t.notificationService.success((0,fe.J)("customer.remove-customers-from-group-success"),{customerCount:1,groupName:e.name}),t.fetchHistory.next()})}},{key:"addNoteToCustomer",value:function(e){var t=this,r=e.note;this.dataService.customer.addNoteToCustomer(this.id,r).subscribe(function(){t.fetchHistory.next(),t.notificationService.success((0,fe.J)("common.notify-create-success"),{entity:"Note"})})}},{key:"updateNote",value:function(e){var t=this;this.modalService.fromComponent(Z.UlA,{closable:!0,locals:{displayPrivacyControls:!1,note:e.data.note}}).pipe((0,f.w)(function(r){return r?t.dataService.customer.updateCustomerNote({noteId:e.id,note:r.note}):Ze.E})).subscribe(function(e){t.fetchHistory.next(),t.notificationService.success((0,fe.J)("common.notify-update-success"),{entity:"Note"})})}},{key:"deleteNote",value:function(e){var t=this;return this.modalService.dialog({title:(0,fe.J)("common.confirm-delete-note"),body:e.data.note,buttons:[{type:"secondary",label:(0,fe.J)("common.cancel")},{type:"danger",label:(0,fe.J)("common.delete"),returnValue:!0}]}).pipe((0,f.w)(function(r){return r?t.dataService.customer.deleteCustomerNote(e.id):Ze.E})).subscribe(function(){t.fetchHistory.next(),t.notificationService.success((0,fe.J)("common.notify-delete-success"),{entity:"Note"})})}},{key:"setFormValues",value:function(e){var r,n=this.detailForm.get("customer");if(n&&n.patchValue({title:e.title,firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phoneNumber,emailAddress:e.emailAddress}),e.addresses){var o,i=new b.Oe([]),s=t(e.addresses);try{for(s.s();!(o=s.n()).done;){var a=o.value,c=a,u=(c.customFields,(0,pe._T)(c,["customFields"])),l=this.formBuilder.group(Object.assign(Object.assign({},u),{countryCode:a.country.code}));if(i.push(l),a.defaultShippingAddress&&(this.defaultShippingAddressId=a.id),a.defaultBillingAddress&&(this.defaultBillingAddressId=a.id),this.addressCustomFields.length){var d,m=this.formBuilder.group({}),p=t(this.addressCustomFields);try{for(p.s();!(d=p.n()).done;){var f=d.value.name,g=null===(r=a.customFields)||void 0===r?void 0:r[f],v=new b.NI(g);m.addControl(f,v)}}catch(h){p.e(h)}finally{p.f()}l.addControl("customFields",m)}}}catch(h){s.e(h)}finally{s.f()}this.detailForm.setControl("addresses",i)}this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["customer","customFields"]),e),this.changeDetector.markForCheck()}},{key:"fetchOrdersList",value:function(){var e=this;this.dataService.customer.getCustomer(this.id,{take:this.ordersPerPage,skip:(this.currentOrdersPage-1)*this.ordersPerPage}).single$.pipe((0,v.U)(function(e){return e.customer}),(0,G.h)(ge.notNullOrUndefined)).subscribe(function(t){return e.orderListUpdates$.next(t)})}}]),i}(Z.UT_);function Dt(e,t){1&e&&(h.TgZ(0,"span"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"customer.update-customer-group")))}function Pt(e,t){1&e&&(h.TgZ(0,"span"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"customer.create-customer-group")))}function Mt(e,t){if(1&e&&(h.YNc(0,Dt,3,3,"span",6),h.YNc(1,Pt,3,3,"span",6)),2&e){var r=h.oxw();h.Q6J("ngIf",r.group.id),h.xp6(1),h.Q6J("ngIf",!r.group.id)}}function Et(e,t){if(1&e&&(h.TgZ(0,"section",7),h.TgZ(1,"label"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h._UZ(4,"vdr-tabbed-custom-fields",8),h.qZA()),2&e){var r=h.oxw();h.xp6(2),h.Oqu(h.lcZ(3,3,"common.custom-fields")),h.xp6(2),h.Q6J("customFields",r.customFields)("customFieldsFormGroup",r.form.get("customFields"))}}function Qt(e,t){1&e&&(h.TgZ(0,"span"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"customer.update-customer-group")))}function $t(e,t){1&e&&(h.TgZ(0,"span"),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.Oqu(h.lcZ(2,1,"customer.create-customer-group")))}function Yt(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"button",9),h.NdJ("click",function(){return h.CHM(r),h.oxw().cancel()}),h._uU(1),h.ALo(2,"translate"),h.qZA(),h.TgZ(3,"button",10),h.NdJ("click",function(){return h.CHM(r),h.oxw().save()}),h.YNc(4,Qt,3,3,"span",6),h.YNc(5,$t,3,3,"span",6),h.qZA()}if(2&e){var n=h.oxw();h.xp6(1),h.Oqu(h.lcZ(2,4,"common.cancel")),h.xp6(2),h.Q6J("disabled",!n.form.valid),h.xp6(1),h.Q6J("ngIf",n.group.id),h.xp6(1),h.Q6J("ngIf",!n.group.id)}}Lt.\u0275fac=function(e){return new(e||Lt)(h.Y36(U.gz),h.Y36(U.F0),h.Y36(Z.iHG),h.Y36(h.sBO),h.Y36(b.qu),h.Y36(Z.DoR),h.Y36(Z.Z7U),h.Y36(Z.gqp))},Lt.\u0275cmp=h.Xpm({type:Lt,selectors:[["vdr-customer-detail"]],features:[h.qOj],decls:46,vars:59,consts:[[1,"flex","clr-align-items-center"],[3,"entity"],[3,"customer"],["class","last-login",3,"title",4,"ngIf"],["locationId","customer-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","title",3,"label","readOnlyToggle"],["id","title","type","text","formControlName","title"],["for","firstName",3,"label","readOnlyToggle"],["id","firstName","type","text","formControlName","firstName"],["for","lastName",3,"label","readOnlyToggle"],["id","lastName","type","text","formControlName","lastName"],["for","emailAddress",3,"label","readOnlyToggle"],["id","emailAddress","type","text","formControlName","emailAddress"],["for","phoneNumber",3,"label","readOnlyToggle"],["id","phoneNumber","type","text","formControlName","phoneNumber"],["for","password",3,"label",4,"ngIf"],["formGroupName","customFields",4,"ngIf"],["locationId","customer-detail",3,"entity$","detailForm"],["class","groups",4,"ngIf"],["class","clr-row",4,"ngIf"],[1,"last-login",3,"title"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],["for","password",3,"label"],["id","password","type","password","formControlName","password"],["formGroupName","customFields"],["entityName","Customer",3,"customFields","customFieldsFormGroup"],[1,"groups"],[1,"clr-control-label"],[4,"ngIf","ngIfElse"],["noGroups",""],["class","btn btn-sm btn-secondary",3,"click",4,"vdrIfPermissions"],["icon","times",3,"colorFrom","iconClick",4,"ngFor","ngForOf"],["icon","times",3,"colorFrom","iconClick"],[1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"],[1,"clr-row"],[1,"clr-col-md-4"],[3,"to-delete","availableCountries","isDefaultBilling","isDefaultShipping","addressForm","customFields","editable","setAsDefaultBilling","setAsDefaultShipping","deleteAddress",4,"ngFor","ngForOf"],["class","btn btn-secondary",3,"click",4,"vdrIfPermissions"],[1,"clr-col-md-8"],[3,"items","itemsPerPage","totalItems","currentPage","emptyStateLabel","itemsPerPageChange","pageChange"],[3,"availableCountries","isDefaultBilling","isDefaultShipping","addressForm","customFields","editable","setAsDefaultBilling","setAsDefaultShipping","deleteAddress"],[1,"btn","btn-secondary",3,"click"],[1,"left"],[1,"right"],["iconShape","shopping-cart",3,"label","linkTo"],[1,"clr-col-md-6"],[3,"customer","history","addNote","updateNote","deleteNote"]],template:function(e,t){if(1&e&&(h.TgZ(0,"vdr-action-bar"),h.TgZ(1,"vdr-ab-left"),h.TgZ(2,"div",0),h._UZ(3,"vdr-entity-info",1),h.ALo(4,"async"),h._UZ(5,"vdr-customer-status-label",2),h.ALo(6,"async"),h.YNc(7,ht,5,10,"div",3),h.ALo(8,"async"),h.qZA(),h.qZA(),h.TgZ(9,"vdr-ab-right"),h._UZ(10,"vdr-action-bar-items",4),h.YNc(11,Zt,3,4,"button",5),h.ALo(12,"async"),h.YNc(13,bt,1,1,"ng-template",null,6,h.W1O),h.qZA(),h.qZA(),h.TgZ(15,"form",7),h.TgZ(16,"vdr-form-field",8),h.ALo(17,"translate"),h.ALo(18,"async"),h._UZ(19,"input",9),h.qZA(),h.TgZ(20,"vdr-form-field",10),h.ALo(21,"translate"),h.ALo(22,"async"),h._UZ(23,"input",11),h.qZA(),h.TgZ(24,"vdr-form-field",12),h.ALo(25,"translate"),h.ALo(26,"async"),h._UZ(27,"input",13),h.qZA(),h.TgZ(28,"vdr-form-field",14),h.ALo(29,"translate"),h.ALo(30,"async"),h._UZ(31,"input",15),h.qZA(),h.TgZ(32,"vdr-form-field",16),h.ALo(33,"translate"),h.ALo(34,"async"),h._UZ(35,"input",17),h.qZA(),h.YNc(36,At,3,3,"vdr-form-field",18),h.ALo(37,"async"),h.YNc(38,Ct,5,6,"section",19),h._UZ(39,"vdr-custom-detail-component-host",20),h.qZA(),h.YNc(40,Ut,9,6,"div",21),h.ALo(41,"async"),h.YNc(42,Jt,29,31,"div",22),h.ALo(43,"async"),h.YNc(44,Ft,5,6,"div",22),h.ALo(45,"async")),2&e){var r,n,o=h.MAs(14);h.xp6(3),h.Q6J("entity",h.lcZ(4,23,t.entity$)),h.xp6(2),h.Q6J("customer",h.lcZ(6,25,t.entity$)),h.xp6(2),h.Q6J("ngIf",null==(r=h.lcZ(8,27,t.entity$))||null==r.user?null:r.user.lastLogin),h.xp6(4),h.Q6J("ngIf",h.lcZ(12,29,t.isNew$))("ngIfElse",o),h.xp6(4),h.Q6J("formGroup",t.detailForm.get("customer")),h.xp6(1),h.Q6J("label",h.lcZ(17,31,"customer.title"))("readOnlyToggle",!h.lcZ(18,33,t.isNew$)),h.xp6(4),h.Q6J("label",h.lcZ(21,35,"customer.first-name"))("readOnlyToggle",!h.lcZ(22,37,t.isNew$)),h.xp6(4),h.Q6J("label",h.lcZ(25,39,"customer.last-name"))("readOnlyToggle",!h.lcZ(26,41,t.isNew$)),h.xp6(4),h.Q6J("label",h.lcZ(29,43,"customer.email-address"))("readOnlyToggle",!h.lcZ(30,45,t.isNew$)),h.xp6(4),h.Q6J("label",h.lcZ(33,47,"customer.phone-number"))("readOnlyToggle",!h.lcZ(34,49,t.isNew$)),h.xp6(4),h.Q6J("ngIf",h.lcZ(37,51,t.isNew$)),h.xp6(2),h.Q6J("ngIf",t.customFields.length),h.xp6(1),h.Q6J("entity$",t.entity$)("detailForm",t.detailForm),h.xp6(1),h.Q6J("ngIf",null==(n=h.lcZ(41,53,t.entity$))?null:n.groups),h.xp6(2),h.Q6J("ngIf",!h.lcZ(43,55,t.isNew$)),h.xp6(2),h.Q6J("ngIf",!h.lcZ(45,57,t.isNew$))}},directives:[Oe.Kk,Oe.BN,ee.V,Fe,J.O5,Oe.mz,Le.W,b._Y,b.JL,b.sg,De.h,N.y,b.Fj,b.JJ,b.u,Pe.C,Me.H,b.x0,re.MgK,Ee.y,J.sg,te.Y,re.qvL,O.Q,S.E,me,I.v,pt],pipes:[J.Ov,k.X$,ft.H,gt.e,F.j,vt.k],styles:[".last-login[_ngcontent-%COMP%]{margin-left:6px;color:var(--color-grey-500)}.to-delete[_ngcontent-%COMP%]{opacity:.5}"],changeDetection:0});var jt=function(){return["CreateCustomerGroup","UpdateCustomerGroup"]},Gt=function(){function e(t,r){p(this,e),this.serverConfigService=t,this.formBuilder=r,this.customFields=this.serverConfigService.getCustomFieldsFor("CustomerGroup")}return g(e,[{key:"ngOnInit",value:function(){var e;if(this.form=this.formBuilder.group({name:[this.group.name,b.kI.required],customFields:this.formBuilder.group(this.customFields.reduce(function(e,t){return Object.assign(Object.assign({},e),u({},t.name,""))},{}))}),this.customFields.length){var r,n=this.form.get("customFields"),o=t(this.customFields);try{for(o.s();!(r=o.n()).done;){var i=r.value.name,s=null===(e=this.group.customFields)||void 0===e?void 0:e[i],a=n.get(i);a&&a.patchValue(s)}}catch(c){o.e(c)}finally{o.f()}}}},{key:"cancel",value:function(){this.resolveWith()}},{key:"save",value:function(){this.resolveWith(this.form.value)}}]),e}();Gt.\u0275fac=function(e){return new(e||Gt)(h.Y36(Z.iHG),h.Y36(b.qu))},Gt.\u0275cmp=h.Xpm({type:Gt,selectors:[["vdr-customer-group-detail-dialog"]],decls:8,vars:9,consts:[["vdrDialogTitle",""],[3,"formGroup"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly"],["formGroupName","customFields",4,"ngIf"],["vdrDialogButtons",""],[4,"ngIf"],["formGroupName","customFields"],["entityName","CustomerGroup",3,"customFields","customFieldsFormGroup"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(h.YNc(0,Mt,2,2,"ng-template",0),h.TgZ(1,"form",1),h.TgZ(2,"vdr-form-field",2),h.ALo(3,"translate"),h._UZ(4,"input",3),h.ALo(5,"hasPermission"),h.qZA(),h.YNc(6,Et,5,5,"section",4),h.qZA(),h.YNc(7,Yt,6,6,"ng-template",5)),2&e&&(h.xp6(1),h.Q6J("formGroup",t.form),h.xp6(1),h.Q6J("label",h.lcZ(3,4,"common.name")),h.xp6(2),h.Q6J("readonly",!h.lcZ(5,6,h.DdM(8,jt))),h.xp6(2),h.Q6J("ngIf",t.customFields.length))},directives:[y.q,b._Y,b.JL,b.sg,De.h,N.y,b.Fj,b.JJ,b.u,J.O5,M.n,b.x0,re.MgK,Ee.y],pipes:[k.X$,F.j],styles:[""],changeDetection:0});var Rt=d(81134),Bt=d(67202),Ht=d(35181);function Vt(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"button",8),h.NdJ("click",function(){return h.CHM(r),h.oxw().create()}),h._UZ(1,"clr-icon",9),h._uU(2),h.ALo(3,"translate"),h.qZA()}2&e&&(h.xp6(2),h.hij(" ",h.lcZ(3,1,"customer.create-new-customer-group")," "))}var Xt=function(e){return{contents:e}},Wt=function(e){return["./",e]};function Kt(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"tr"),h.ALo(1,"async"),h.TgZ(2,"td",12),h._UZ(3,"vdr-entity-info",13),h.qZA(),h.TgZ(4,"td",12),h.TgZ(5,"vdr-chip",14),h._uU(6),h.qZA(),h.qZA(),h.TgZ(7,"td",15),h.TgZ(8,"a",16),h._UZ(9,"clr-icon",17),h._uU(10),h.ALo(11,"translate"),h.qZA(),h.qZA(),h.TgZ(12,"td",18),h.TgZ(13,"button",19),h.NdJ("click",function(){var e=h.CHM(r).$implicit;return h.oxw(2).update(e)}),h._UZ(14,"clr-icon",20),h._uU(15),h.ALo(16,"translate"),h.qZA(),h.qZA(),h.TgZ(17,"td",18),h.TgZ(18,"vdr-dropdown"),h.TgZ(19,"button",21),h._uU(20),h.ALo(21,"translate"),h._UZ(22,"clr-icon",22),h.qZA(),h.TgZ(23,"vdr-dropdown-menu",23),h.TgZ(24,"button",24),h.NdJ("click",function(){var e=h.CHM(r).$implicit;return h.oxw(2).delete(e.id)}),h.ALo(25,"hasPermission"),h._UZ(26,"clr-icon",25),h._uU(27),h.ALo(28,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&e){var n,o=t.$implicit,i=h.oxw(2);h.ekj("active",o.id===(null==(n=h.lcZ(1,11,i.activeGroup$))?null:n.id)),h.xp6(3),h.Q6J("entity",o),h.xp6(2),h.Q6J("colorFrom",o.id),h.xp6(1),h.Oqu(o.name),h.xp6(2),h.Q6J("routerLink",h.VKq(25,Wt,h.VKq(23,Xt,o.id))),h.xp6(2),h.hij(" ",h.lcZ(11,13,"customer.view-group-members")," "),h.xp6(5),h.hij(" ",h.lcZ(16,15,"common.edit")," "),h.xp6(5),h.hij(" ",h.lcZ(21,17,"common.actions")," "),h.xp6(4),h.Q6J("disabled",!h.lcZ(25,19,"DeleteCustomerGroup")),h.xp6(3),h.hij(" ",h.lcZ(28,21,"common.delete")," ")}}function zt(e,t){if(1&e&&(h.TgZ(0,"table",10),h.ALo(1,"async"),h.TgZ(2,"tbody"),h.YNc(3,Kt,29,27,"tr",11),h.ALo(4,"async"),h.qZA(),h.qZA()),2&e){var r=h.oxw();h.ekj("expanded",h.lcZ(1,3,r.activeGroup$)),h.xp6(3),h.Q6J("ngForOf",h.lcZ(4,5,r.groups$))}}function er(e,t){1&e&&h._UZ(0,"vdr-empty-placeholder")}var tr=function(e){return{groupName:e}};function rr(e,t){if(1&e){var r=h.EpF();h.ynx(0),h.TgZ(1,"div",26),h.TgZ(2,"div",27),h._uU(3),h.ALo(4,"async"),h.qZA(),h._UZ(5,"div",28),h.TgZ(6,"button",29),h.NdJ("click",function(){return h.CHM(r),h.oxw().closeMembers()}),h._UZ(7,"clr-icon",30),h.qZA(),h.qZA(),h.TgZ(8,"div",31),h.TgZ(9,"vdr-dropdown"),h.TgZ(10,"button",32),h._uU(11),h.ALo(12,"translate"),h._UZ(13,"clr-icon",22),h.qZA(),h.TgZ(14,"vdr-dropdown-menu",23),h.TgZ(15,"button",33),h.NdJ("click",function(){var e=h.CHM(r).ngIf,t=h.oxw();return t.removeFromGroup(e,t.selectedCustomerIds)}),h.ALo(16,"hasPermission"),h._UZ(17,"clr-icon",25),h._uU(18),h.ALo(19,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(20,"button",34),h.NdJ("click",function(){var e=h.CHM(r).ngIf;return h.oxw().addToGroup(e)}),h._uU(21),h.ALo(22,"translate"),h.qZA(),h.qZA(),h.TgZ(23,"vdr-customer-group-member-list",35),h.NdJ("selectionChange",function(e){return h.CHM(r),h.oxw().selectedCustomerIds=e})("fetchParamsChange",function(e){return h.CHM(r),h.oxw().fetchGroupMembers$.next(e)}),h.ALo(24,"async"),h.ALo(25,"async"),h.qZA(),h.BQk()}if(2&e){var n=t.ngIf,o=h.oxw();h.xp6(3),h.AsE("",n.name," (",h.lcZ(4,11,o.membersTotal$),")"),h.xp6(7),h.Q6J("disabled",0===o.selectedCustomerIds.length),h.xp6(1),h.hij(" ",h.lcZ(12,13,"common.with-selected")," "),h.xp6(4),h.Q6J("disabled",!h.lcZ(16,15,"UpdateCustomerGroup")),h.xp6(3),h.hij(" ",h.lcZ(19,17,"customer.remove-from-group")," "),h.xp6(3),h.hij(" ",h.xi3(22,19,"customer.add-customers-to-group",h.VKq(26,tr,n.name))," "),h.xp6(2),h.Q6J("members",h.lcZ(24,22,o.members$))("route",o.route)("totalItems",h.lcZ(25,24,o.membersTotal$))("selectedMemberIds",o.selectedCustomerIds)}}var nr=function(){function e(t,r,n,o,i){p(this,e),this.dataService=t,this.notificationService=r,this.modalService=n,this.route=o,this.router=i,this.selectedCustomerIds=[],this.fetchGroupMembers$=new m.X({skip:0,take:0,filterTerm:""}),this.refreshActiveGroupMembers$=new m.X(void 0)}return g(e,[{key:"ngOnInit",value:function(){var e=this;this.groups$=this.dataService.customer.getCustomerGroupList().mapStream(function(e){return e.customerGroups.items});var t=this.route.paramMap.pipe((0,v.U)(function(e){return e.get("contents")}),(0,T.x)(),(0,w.b)(function(){return e.selectedCustomerIds=[]}));this.listIsEmpty$=this.groups$.pipe((0,v.U)(function(e){return 0===e.length})),this.activeGroup$=(0,x.aj)(this.groups$,t).pipe((0,v.U)(function(e){var t=l(e,2),r=t[0],n=t[1];if(n)return r.find(function(e){return e.id===n})}));var r=(0,x.aj)(this.activeGroup$,this.fetchGroupMembers$,this.refreshActiveGroupMembers$).pipe((0,f.w)(function(t){var r=l(t,2),n=r[0],o=r[1],i=o.skip,s=o.take,a=o.filterTerm;return n?e.dataService.customer.getCustomerGroupWithCustomers(n.id,{skip:i,take:s,filter:{emailAddress:{contains:a}}}).mapStream(function(e){var t;return null===(t=e.customerGroup)||void 0===t?void 0:t.customers}):(0,Rt.of)(void 0)}));this.members$=r.pipe((0,v.U)(function(e){var t;return null!==(t=null==e?void 0:e.items)&&void 0!==t?t:[]})),this.membersTotal$=r.pipe((0,v.U)(function(e){var t;return null!==(t=null==e?void 0:e.totalItems)&&void 0!==t?t:0}))}},{key:"create",value:function(){var e=this;this.modalService.fromComponent(Gt,{locals:{group:{name:""}}}).pipe((0,f.w)(function(t){return t?e.dataService.customer.createCustomerGroup(Object.assign(Object.assign({},t),{customerIds:[]})):Ze.E}),(0,f.w)(function(){return e.dataService.customer.getCustomerGroupList().single$})).subscribe(function(){e.notificationService.success((0,fe.J)("common.notify-create-success"),{entity:"CustomerGroup"})},function(t){e.notificationService.error((0,fe.J)("common.notify-create-error"),{entity:"CustomerGroup"})})}},{key:"delete",value:function(e){var t=this;this.modalService.dialog({title:(0,fe.J)("customer.confirm-delete-customer-group"),buttons:[{type:"secondary",label:(0,fe.J)("common.cancel")},{type:"danger",label:(0,fe.J)("common.delete"),returnValue:!0}]}).pipe((0,f.w)(function(r){return r?t.dataService.customer.deleteCustomerGroup(e):Ze.E}),(0,f.w)(function(e){return e.deleteCustomerGroup.result===Z.PcR.DELETED?t.dataService.customer.getCustomerGroupList().mapSingle(function(){return{errorMessage:!1}}):(0,Rt.of)({errorMessage:e.deleteCustomerGroup.message})})).subscribe(function(e){"string"==typeof e.errorMessage?t.notificationService.error(e.errorMessage):t.notificationService.success((0,fe.J)("common.notify-delete-success"),{entity:"CustomerGroup"})},function(e){t.notificationService.error((0,fe.J)("common.notify-delete-error"),{entity:"CustomerGroup"})})}},{key:"update",value:function(e){var t=this;this.modalService.fromComponent(Gt,{locals:{group:e}}).pipe((0,f.w)(function(r){return r?t.dataService.customer.updateCustomerGroup(Object.assign({id:e.id},r)):Ze.E})).subscribe(function(){t.notificationService.success((0,fe.J)("common.notify-update-success"),{entity:"CustomerGroup"})},function(e){t.notificationService.error((0,fe.J)("common.notify-update-error"),{entity:"CustomerGroup"})})}},{key:"closeMembers",value:function(){var e=Object.assign({},this.route.snapshot.params);delete e.contents,this.router.navigate(["./",e],{relativeTo:this.route,queryParamsHandling:"preserve"})}},{key:"addToGroup",value:function(e){var t=this;this.modalService.fromComponent(j,{locals:{group:e,route:this.route},size:"md",verticalAlign:"top"}).pipe((0,f.w)(function(r){return r?t.dataService.customer.addCustomersToGroup(e.id,r).pipe((0,Bt.h)(r)):Ze.E})).subscribe({next:function(r){t.notificationService.success((0,fe.J)("customer.add-customers-to-group-success"),{customerCount:r.length,groupName:e.name}),t.refreshActiveGroupMembers$.next(),t.selectedCustomerIds=[]}})}},{key:"removeFromGroup",value:function(e,t){var r=this;this.dataService.customer.removeCustomersFromGroup(e.id,t).subscribe({complete:function(){r.notificationService.success((0,fe.J)("customer.remove-customers-from-group-success"),{customerCount:t.length,groupName:e.name}),r.refreshActiveGroupMembers$.next(),r.selectedCustomerIds=[]}})}}]),e}();nr.\u0275fac=function(e){return new(e||nr)(h.Y36(Z.DoR),h.Y36(Z.gqp),h.Y36(Z.Z7U),h.Y36(U.gz),h.Y36(U.F0))},nr.\u0275cmp=h.Xpm({type:nr,selectors:[["vdr-customer-group-list"]],decls:15,vars:12,consts:[["locationId","customer-group-list"],["class","btn btn-primary",3,"click",4,"vdrIfPermissions"],[1,"group-wrapper"],[1,"group-list"],["class","table mt0",3,"expanded",4,"ngIf","ngIfElse"],["emptyPlaceholder",""],[1,"group-members"],[4,"ngIf"],[1,"btn","btn-primary",3,"click"],["shape","plus"],[1,"table","mt0"],[3,"active",4,"ngFor","ngForOf"],[1,"left","align-middle"],[3,"entity"],[3,"colorFrom"],[1,"text-right","align-middle"],["queryParamsHandling","preserve",1,"btn","btn-link","btn-sm",3,"routerLink"],["shape","view-list"],[1,"align-middle"],[1,"btn","btn-link","btn-sm",3,"click"],["shape","edit"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["vdrDropdownItem","",1,"button",3,"disabled","click"],["shape","trash",1,"is-danger"],[1,"flex"],[1,"header-title-row"],[1,"flex-spacer"],["type","button",1,"close-button",3,"click"],["shape","close"],[1,"controls"],["type","button","vdrDropdownTrigger","",1,"btn","btn-secondary","btn-sm",3,"disabled"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],[1,"btn","btn-secondary","btn-sm",3,"click"],[3,"members","route","totalItems","selectedMemberIds","selectionChange","fetchParamsChange"]],template:function(e,t){if(1&e&&(h.TgZ(0,"vdr-action-bar"),h._UZ(1,"vdr-ab-left"),h.TgZ(2,"vdr-ab-right"),h._UZ(3,"vdr-action-bar-items",0),h.YNc(4,Vt,4,3,"button",1),h.qZA(),h.qZA(),h.TgZ(5,"div",2),h.TgZ(6,"div",3),h.YNc(7,zt,5,7,"table",4),h.ALo(8,"async"),h.qZA(),h.YNc(9,er,1,0,"ng-template",null,5,h.W1O),h.TgZ(11,"div",6),h.ALo(12,"async"),h.YNc(13,rr,26,28,"ng-container",7),h.ALo(14,"async"),h.qZA(),h.qZA()),2&e){var r=h.MAs(10);h.xp6(4),h.Q6J("vdrIfPermissions","CreateCustomerGroup"),h.xp6(3),h.Q6J("ngIf",!h.lcZ(8,6,t.listIsEmpty$))("ngIfElse",r),h.xp6(4),h.ekj("expanded",h.lcZ(12,8,t.activeGroup$)),h.xp6(2),h.Q6J("ngIf",h.lcZ(14,10,t.activeGroup$))}},directives:[Oe.Kk,Oe.BN,Oe.mz,Le.W,Me.H,J.O5,re.qvL,J.sg,ee.V,te.Y,U.yS,ne.J,oe.U,ie.N,se.H,Ht.j,P],pipes:[J.Ov,k.X$,F.j],styles:[".group-wrapper[_ngcontent-%COMP%]{display:flex;height:calc(100% - 50px)}.group-wrapper[_ngcontent-%COMP%]   .group-list[_ngcontent-%COMP%]{flex:1;overflow:auto;margin-top:0}.group-wrapper[_ngcontent-%COMP%]   .group-list[_ngcontent-%COMP%]   tr.active[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}.group-wrapper[_ngcontent-%COMP%]   .group-list.expanded[_ngcontent-%COMP%]{width:calc(100% - 40vw)}.group-members[_ngcontent-%COMP%]{height:100%;width:0;opacity:0;visibility:hidden;overflow:auto;transition:width .3s,opacity .2s .3s,visibility 0s .3s}.group-members.expanded[_ngcontent-%COMP%]{width:40vw;visibility:visible;opacity:1;padding-left:12px}.group-members[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{margin:0;background:none;border:none;cursor:pointer}.group-members[_ngcontent-%COMP%]     table.table{margin-top:0}.group-members[_ngcontent-%COMP%]     table.table th{top:0}.group-members[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between}vdr-empty-placeholder[_ngcontent-%COMP%]{flex:1}"],changeDetection:0});var or=d(430),ir=function(){return["./create"]};function sr(e,t){1&e&&(h.TgZ(0,"a",5),h._UZ(1,"clr-icon",6),h._uU(2),h.ALo(3,"translate"),h.qZA()),2&e&&(h.Q6J("routerLink",h.DdM(4,ir)),h.xp6(2),h.hij(" ",h.lcZ(3,2,"customer.create-new-customer")," "))}var ar=function(e){return["./",e]};function cr(e,t){if(1&e){var r=h.EpF();h.TgZ(0,"td",7),h._uU(1),h.qZA(),h.TgZ(2,"td",7),h._uU(3),h.qZA(),h.TgZ(4,"td",7),h._UZ(5,"vdr-customer-status-label",8),h.qZA(),h.TgZ(6,"td",9),h._UZ(7,"vdr-table-row-action",10),h.ALo(8,"translate"),h.qZA(),h.TgZ(9,"td"),h.TgZ(10,"vdr-dropdown"),h.TgZ(11,"button",11),h._uU(12),h.ALo(13,"translate"),h._UZ(14,"clr-icon",12),h.qZA(),h.TgZ(15,"vdr-dropdown-menu",13),h.TgZ(16,"button",14),h.NdJ("click",function(){var e=h.CHM(r).item;return h.oxw().deleteCustomer(e)}),h.ALo(17,"hasPermission"),h._UZ(18,"clr-icon",15),h._uU(19),h.ALo(20,"translate"),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&e){var n=t.item;h.xp6(1),h.lnq(" ",n.title," ",n.firstName," ",n.lastName," "),h.xp6(2),h.Oqu(n.emailAddress),h.xp6(2),h.Q6J("customer",n),h.xp6(2),h.Q6J("label",h.lcZ(8,10,"common.edit"))("linkTo",h.VKq(18,ar,n.id)),h.xp6(5),h.hij(" ",h.lcZ(13,12,"common.actions")," "),h.xp6(4),h.Q6J("disabled",!h.lcZ(17,14,"DeleteCustomer")),h.xp6(3),h.hij(" ",h.lcZ(20,16,"common.delete")," ")}}var ur=function(t){r(i,t);var n=o(i);function i(t,r,o,c,u){var l,d;return p(this,i),(d=n.call(this,r,o)).dataService=t,d.modalService=c,d.notificationService=u,d.searchTerm=new b.NI(""),e((l=s(d),a(i.prototype)),"setQueryFn",l).call(l,function(){var e;return(e=d.dataService.customer).getCustomerList.apply(e,arguments).refetchOnChannelChange()},function(e){return e.customers},function(e,t){return{options:{skip:e,take:t,filter:{emailAddress:{contains:d.searchTerm.value},lastName:{contains:d.searchTerm.value},postalCode:{contains:d.searchTerm.value}},filterOperator:Z.FnJ.OR,sort:{createdAt:or.As.DESC}}}}),d}return g(i,[{key:"ngOnInit",value:function(){var t=this;e(a(i.prototype),"ngOnInit",this).call(this),this.searchTerm.valueChanges.pipe((0,G.h)(function(e){return 2<e.length||0===e.length}),(0,_.b)(250),(0,q.R)(this.destroy$)).subscribe(function(){return t.refresh()})}},{key:"deleteCustomer",value:function(e){var t=this;return this.modalService.dialog({title:(0,fe.J)("catalog.confirm-delete-customer"),body:"".concat(e.firstName," ").concat(e.lastName),buttons:[{type:"secondary",label:(0,fe.J)("common.cancel")},{type:"danger",label:(0,fe.J)("common.delete"),returnValue:!0}]}).pipe((0,f.w)(function(r){return r?t.dataService.customer.deleteCustomer(e.id):Ze.E})).subscribe(function(){t.notificationService.success((0,fe.J)("common.notify-delete-success"),{entity:"Customer"}),t.refresh()},function(e){t.notificationService.error((0,fe.J)("common.notify-delete-error"),{entity:"Customer"})})}}]),i}(Z.t7C);ur.\u0275fac=function(e){return new(e||ur)(h.Y36(Z.DoR),h.Y36(U.F0),h.Y36(U.gz),h.Y36(Z.Z7U),h.Y36(Z.gqp))},ur.\u0275cmp=h.Xpm({type:ur,selectors:[["vdr-customer-list"]],features:[h.qOj],decls:24,vars:28,consts:[["type","text","name","emailSearchTerm",1,"search-input","ml3",3,"formControl","placeholder"],["locationId","customer-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[3,"expand"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],[3,"customer"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(h.TgZ(0,"vdr-action-bar"),h.TgZ(1,"vdr-ab-left"),h._UZ(2,"input",0),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"vdr-ab-right"),h._UZ(5,"vdr-action-bar-items",1),h.YNc(6,sr,4,5,"a",2),h.qZA(),h.qZA(),h.TgZ(7,"vdr-data-table",3),h.NdJ("pageChange",function(e){return t.setPageNumber(e)})("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),h.ALo(8,"async"),h.ALo(9,"async"),h.ALo(10,"async"),h.ALo(11,"async"),h.TgZ(12,"vdr-dt-column",4),h._uU(13),h.ALo(14,"translate"),h.qZA(),h.TgZ(15,"vdr-dt-column",4),h._uU(16),h.ALo(17,"translate"),h.qZA(),h.TgZ(18,"vdr-dt-column"),h._uU(19),h.ALo(20,"translate"),h.qZA(),h._UZ(21,"vdr-dt-column"),h._UZ(22,"vdr-dt-column"),h.YNc(23,cr,21,20,"ng-template"),h.qZA()),2&e&&(h.xp6(2),h.Q6J("formControl",t.searchTerm)("placeholder",h.lcZ(3,12,"customer.search-customers-by-email-last-name-postal-code")),h.xp6(4),h.Q6J("vdrIfPermissions","CreateCustomer"),h.xp6(1),h.Q6J("items",h.lcZ(8,14,t.items$))("itemsPerPage",h.lcZ(9,16,t.itemsPerPage$))("totalItems",h.lcZ(10,18,t.totalItems$))("currentPage",h.lcZ(11,20,t.currentPage$)),h.xp6(5),h.Q6J("expand",!0),h.xp6(1),h.Oqu(h.lcZ(14,22,"customer.name")),h.xp6(2),h.Q6J("expand",!0),h.xp6(1),h.Oqu(h.lcZ(17,24,"customer.email-address")),h.xp6(3),h.Oqu(h.lcZ(20,26,"customer.customer-type")))},directives:[Oe.Kk,Oe.BN,N.y,b.Fj,b.JJ,b.oH,Oe.mz,Le.W,Me.H,O.Q,S.E,U.yS,re.qvL,Fe,I.v,ne.J,oe.U,ie.N,se.H],pipes:[k.X$,J.Ov,F.j],styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"]});var lr=function(e){r(n,e);var t=o(n);function n(e,r){return p(this,n),t.call(this,e,{__typename:"Customer",id:"",createdAt:"",updatedAt:"",title:"",firstName:"",lastName:"",emailAddress:"",phoneNumber:null,addresses:null,user:null},function(e){return r.customer.getCustomer(e).mapStream(function(e){return e.customer})})}return n}(Z.p_9);lr.\u0275fac=function(e){return new(e||lr)(h.LFG(U.F0),h.LFG(Z.DoR))},lr.\u0275prov=h.Yz7({token:lr,factory:lr.\u0275fac,providedIn:"root"});var dr=[{path:"customers",component:ur,pathMatch:"",data:{breadcrumb:(0,fe.J)("breadcrumb.customers")}},{path:"customers/:id",component:Lt,resolve:(0,Z.Po4)(lr),canDeactivate:[Z.TSp],data:{breadcrumb:mr}},{path:"groups",component:nr,data:{breadcrumb:(0,fe.J)("breadcrumb.customer-groups")}}];function mr(e,t){return(0,Z.YWC)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.customers",getName:function(e){return"".concat(e.firstName," ").concat(e.lastName)},route:"customers"})}var pr=function e(){p(this,e)};pr.\u0275fac=function(e){return new(e||pr)},pr.\u0275mod=h.oAB({type:pr}),pr.\u0275inj=h.cJS({imports:[[Z.m81,U.Bz.forChild(dr)]]})}}])}();
//# sourceMappingURL=776-es5.ff2bca4790d73c9fecfe.js.map