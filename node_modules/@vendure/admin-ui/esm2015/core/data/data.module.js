import { HttpClientModule, HTTP_INTERCEPTORS } from '@angular/common/http';
import { APP_INITIALIZER, Injector, NgModule } from '@angular/core';
import { InMemoryCache } from '@apollo/client/core';
import { setContext } from '@apollo/client/link/context';
import { ApolloLink } from '@apollo/client/link/core';
import { APOLLO_OPTIONS } from 'apollo-angular';
import { createUploadLink } from 'apollo-upload-client';
import { getAppConfig } from '../app.config';
import { introspectionResult } from '../common/introspection-result-wrapper';
import { LocalStorageService } from '../providers/local-storage/local-storage.service';
import { CheckJobsLink } from './check-jobs-link';
import { getClientDefaults } from './client-state/client-defaults';
import { clientResolvers } from './client-state/client-resolvers';
import { GET_CLIENT_STATE } from './definitions/client-definitions';
import { OmitTypenameLink } from './omit-typename-link';
import { BaseDataService } from './providers/base-data.service';
import { DataService } from './providers/data.service';
import { FetchAdapter } from './providers/fetch-adapter';
import { DefaultInterceptor } from './providers/interceptor';
import { initializeServerConfigService, ServerConfigService } from './server-config';
import { getServerLocation } from './utils/get-server-location';
export function createApollo(localStorageService, fetchAdapter, injector) {
    const { adminApiPath, tokenMethod } = getAppConfig();
    const serverLocation = getServerLocation();
    const apolloCache = new InMemoryCache({
        possibleTypes: introspectionResult.possibleTypes,
        typePolicies: {
            GlobalSettings: {
                fields: {
                    serverConfig: {
                        merge: (existing, incoming) => (Object.assign(Object.assign({}, existing), incoming)),
                    },
                },
            },
        },
    });
    apolloCache.writeQuery({
        query: GET_CLIENT_STATE,
        data: getClientDefaults(localStorageService),
    });
    if (!false) {
        // TODO: enable only for dev mode
        // make the Apollo Cache inspectable in the console for debug purposes
        window['apolloCache'] = apolloCache;
    }
    return {
        link: ApolloLink.from([
            new OmitTypenameLink(),
            new CheckJobsLink(injector),
            setContext(() => {
                const headers = {};
                const channelToken = localStorageService.get('activeChannelToken');
                if (channelToken) {
                    headers['vendure-token'] = channelToken;
                }
                if (tokenMethod === 'bearer') {
                    const authToken = localStorageService.get('authToken');
                    if (authToken) {
                        headers.authorization = `Bearer ${authToken}`;
                    }
                }
                return { headers };
            }),
            createUploadLink({
                uri: `${serverLocation}/${adminApiPath}`,
                fetch: fetchAdapter.fetch,
            }),
        ]),
        cache: apolloCache,
        resolvers: clientResolvers,
    };
}
const ɵ0 = initializeServerConfigService;
/**
 * The DataModule is responsible for all API calls *and* serves as the source of truth for global app
 * state via the apollo-link-state package.
 */
export class DataModule {
}
DataModule.decorators = [
    { type: NgModule, args: [{
                imports: [HttpClientModule],
                exports: [],
                declarations: [],
                providers: [
                    BaseDataService,
                    DataService,
                    FetchAdapter,
                    ServerConfigService,
                    {
                        provide: APOLLO_OPTIONS,
                        useFactory: createApollo,
                        deps: [LocalStorageService, FetchAdapter, Injector],
                    },
                    { provide: HTTP_INTERCEPTORS, useClass: DefaultInterceptor, multi: true },
                    {
                        provide: APP_INITIALIZER,
                        multi: true,
                        useFactory: ɵ0,
                        deps: [ServerConfigService],
                    },
                ],
            },] }
];
export { ɵ0 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YS5tb2R1bGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbGliL2NvcmUvc3JjL2RhdGEvZGF0YS5tb2R1bGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGdCQUFnQixFQUFFLGlCQUFpQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDM0UsT0FBTyxFQUFFLGVBQWUsRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3BFLE9BQU8sRUFBdUIsYUFBYSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDekUsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ3pELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDaEQsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFFeEQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM3QyxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSx3Q0FBd0MsQ0FBQztBQUM3RSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxrREFBa0QsQ0FBQztBQUV2RixPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFDbkUsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQ2xFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBQ3BFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3hELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUNoRSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0s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QkFDRCxFQUFFLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxRQUFRLEVBQUUsa0JBQWtCLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRTtvQkFDekU7d0JBQ0ksT0FBTyxFQUFFLGVBQWU7d0JBQ3hCLEtBQUssRUFBRSxJQUFJO3dCQUNYLFVBQVUsSUFBK0I7d0JBQ3pDLElBQUksRUFBRSxDQUFDLG1CQUFtQixDQUFDO3FCQUM5QjtpQkFDSjthQUNKIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSHR0cENsaWVudE1vZHVsZSwgSFRUUF9JTlRFUkNFUFRPUlMgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XHJcbmltcG9ydCB7IEFQUF9JTklUSUFMSVpFUiwgSW5qZWN0b3IsIE5nTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEFwb2xsb0NsaWVudE9wdGlvbnMsIEluTWVtb3J5Q2FjaGUgfSBmcm9tICdAYXBvbGxvL2NsaWVudC9jb3JlJztcclxuaW1wb3J0IHsgc2V0Q29udGV4dCB9IGZyb20gJ0BhcG9sbG8vY2xpZW50L2xpbmsvY29udGV4dCc7XHJcbmltcG9ydCB7IEFwb2xsb0xpbmsgfSBmcm9tICdAYXBvbGxvL2NsaWVudC9saW5rL2NvcmUnO1xyXG5pbXBvcnQgeyBBUE9MTE9fT1BUSU9OUyB9IGZyb20gJ2Fwb2xsby1hbmd1bGFyJztcclxuaW1wb3J0IHsgY3JlYXRlVXBsb2FkTGluayB9IGZyb20gJ2Fwb2xsby11cGxvYWQtY2xpZW50JztcclxuXHJcbmltcG9ydCB7IGdldEFwcENvbmZpZyB9IGZyb20gJy4uL2FwcC5jb25maWcnO1xyXG5pbXBvcnQgeyBpbnRyb3NwZWN0aW9uUmVzdWx0IH0gZnJvbSAnLi4vY29tbW9uL2ludHJvc3BlY3Rpb24tcmVzdWx0LXdyYXBwZXInO1xyXG5pbXBvcnQgeyBMb2NhbFN0b3JhZ2VTZXJ2aWNlIH0gZnJvbSAnLi4vcHJvdmlkZXJzL2xvY2FsLXN0b3JhZ2UvbG9jYWwtc3RvcmFnZS5zZXJ2aWNlJztcclxuXHJcbmltcG9ydCB7IENoZWNrSm9ic0xpbmsgfSBmcm9tICcuL2NoZWNrLWpvYnMtbGluayc7XHJcbmltcG9ydCB7IGdldENsaWVudERlZmF1bHRzIH0gZnJvbSAnLi9jbGllbnQtc3RhdGUvY2xpZW50LWRlZmF1bHRzJztcclxuaW1wb3J0IHsgY2xpZW50UmVzb2x2ZXJzIH0gZnJvbSAnLi9jbGllbnQtc3RhdGUvY2xpZW50LXJlc29sdmVycyc7XHJcbmltcG9ydCB7IEdFVF9DTElFTlRfU1RBVEUgfSBmcm9tICcuL2RlZmluaXRpb25zL2NsaWVudC1kZWZpbml0aW9ucyc7XHJcbmltcG9ydCB7IE9taXRUeXBlbmFtZUxpbmsgfSBmcm9tICcuL29taXQtdHlwZW5hbWUtbGluayc7XHJcbmltcG9ydCB7IEJhc2VEYXRhU2VydmljZSB9IGZyb20gJy4vcHJvdmlkZXJzL2Jhc2UtZGF0YS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgRGF0YVNlcnZpY2UgfSBmcm9tICcuL3Byb3ZpZGVycy9kYXRhLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBGZXRjaEFkYXB0ZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9mZXRjaC1hZGFwdGVyJztcclxuaW1wb3J0IHsgRGVmYXVsdEludGVyY2VwdG9yIH0gZnJvbSAnLi9wcm92aWRlcnMvaW50ZXJjZXB0b3InO1xyXG5pbXBvcnQgeyBpbml0aWFsaXplU2VydmVyQ29uZmlnU2VydmljZSwgU2VydmVyQ29uZmlnU2VydmljZSB9IGZyb20gJy4vc2VydmVyLWNvbmZpZyc7XHJcbmltcG9ydCB7IGdldFNlcnZlckxvY2F0aW9uIH0gZnJvbSAnLi91dGlscy9nZXQtc2VydmVyLWxvY2F0aW9uJztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBcG9sbG8oXHJcbiAgICBsb2NhbFN0b3JhZ2VTZXJ2aWNlOiBMb2NhbFN0b3JhZ2VTZXJ2aWNlLFxyXG4gICAgZmV0Y2hBZGFwdGVyOiBGZXRjaEFkYXB0ZXIsXHJcbiAgICBpbmplY3RvcjogSW5qZWN0b3IsXHJcbik6IEFwb2xsb0NsaWVudE9wdGlvbnM8YW55PiB7XHJcbiAgICBjb25zdCB7IGFkbWluQXBpUGF0aCwgdG9rZW5NZXRob2QgfSA9IGdldEFwcENvbmZpZygpO1xyXG4gICAgY29uc3Qgc2VydmVyTG9jYXRpb24gPSBnZXRTZXJ2ZXJMb2NhdGlvbigpO1xyXG4gICAgY29uc3QgYXBvbGxvQ2FjaGUgPSBuZXcgSW5NZW1vcnlDYWNoZSh7XHJcbiAgICAgICAgcG9zc2libGVUeXBlczogaW50cm9zcGVjdGlvblJlc3VsdC5wb3NzaWJsZVR5cGVzLFxyXG4gICAgICAgIHR5cGVQb2xpY2llczoge1xyXG4gICAgICAgICAgICBHbG9iYWxTZXR0aW5nczoge1xyXG4gICAgICAgICAgICAgICAgZmllbGRzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VydmVyQ29uZmlnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lcmdlOiAoZXhpc3RpbmcsIGluY29taW5nKSA9PiAoeyAuLi5leGlzdGluZywgLi4uaW5jb21pbmcgfSksXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgYXBvbGxvQ2FjaGUud3JpdGVRdWVyeSh7XHJcbiAgICAgICAgcXVlcnk6IEdFVF9DTElFTlRfU1RBVEUsXHJcbiAgICAgICAgZGF0YTogZ2V0Q2xpZW50RGVmYXVsdHMobG9jYWxTdG9yYWdlU2VydmljZSksXHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoIWZhbHNlKSB7XHJcbiAgICAgICAgLy8gVE9ETzogZW5hYmxlIG9ubHkgZm9yIGRldiBtb2RlXHJcbiAgICAgICAgLy8gbWFrZSB0aGUgQXBvbGxvIENhY2hlIGluc3BlY3RhYmxlIGluIHRoZSBjb25zb2xlIGZvciBkZWJ1ZyBwdXJwb3Nlc1xyXG4gICAgICAgICh3aW5kb3cgYXMgYW55KVsnYXBvbGxvQ2FjaGUnXSA9IGFwb2xsb0NhY2hlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBsaW5rOiBBcG9sbG9MaW5rLmZyb20oW1xyXG4gICAgICAgICAgICBuZXcgT21pdFR5cGVuYW1lTGluaygpLFxyXG4gICAgICAgICAgICBuZXcgQ2hlY2tKb2JzTGluayhpbmplY3RvciksXHJcbiAgICAgICAgICAgIHNldENvbnRleHQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaGVhZGVyczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbm5lbFRva2VuID0gbG9jYWxTdG9yYWdlU2VydmljZS5nZXQoJ2FjdGl2ZUNoYW5uZWxUb2tlbicpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNoYW5uZWxUb2tlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbJ3ZlbmR1cmUtdG9rZW4nXSA9IGNoYW5uZWxUb2tlbjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0b2tlbk1ldGhvZCA9PT0gJ2JlYXJlcicpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhdXRoVG9rZW4gPSBsb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldCgnYXV0aFRva2VuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF1dGhUb2tlbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzLmF1dGhvcml6YXRpb24gPSBgQmVhcmVyICR7YXV0aFRva2VufWA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgaGVhZGVycyB9O1xyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgY3JlYXRlVXBsb2FkTGluayh7XHJcbiAgICAgICAgICAgICAgICB1cmk6IGAke3NlcnZlckxvY2F0aW9ufS8ke2FkbWluQXBpUGF0aH1gLFxyXG4gICAgICAgICAgICAgICAgZmV0Y2g6IGZldGNoQWRhcHRlci5mZXRjaCxcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgXSksXHJcbiAgICAgICAgY2FjaGU6IGFwb2xsb0NhY2hlLFxyXG4gICAgICAgIHJlc29sdmVyczogY2xpZW50UmVzb2x2ZXJzLFxyXG4gICAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRoZSBEYXRhTW9kdWxlIGlzIHJlc3BvbnNpYmxlIGZvciBhbGwgQVBJIGNhbGxzICphbmQqIHNlcnZlcyBhcyB0aGUgc291cmNlIG9mIHRydXRoIGZvciBnbG9iYWwgYXBwXHJcbiAqIHN0YXRlIHZpYSB0aGUgYXBvbGxvLWxpbmstc3RhdGUgcGFja2FnZS5cclxuICovXHJcbkBOZ01vZHVsZSh7XHJcbiAgICBpbXBvcnRzOiBbSHR0cENsaWVudE1vZHVsZV0sXHJcbiAgICBleHBvcnRzOiBbXSxcclxuICAgIGRlY2xhcmF0aW9uczogW10sXHJcbiAgICBwcm92aWRlcnM6IFtcclxuICAgICAgICBCYXNlRGF0YVNlcnZpY2UsXHJcbiAgICAgICAgRGF0YVNlcnZpY2UsXHJcbiAgICAgICAgRmV0Y2hBZGFwdGVyLFxyXG4gICAgICAgIFNlcnZlckNvbmZpZ1NlcnZpY2UsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBwcm92aWRlOiBBUE9MTE9fT1BUSU9OUyxcclxuICAgICAgICAgICAgdXNlRmFjdG9yeTogY3JlYXRlQXBvbGxvLFxyXG4gICAgICAgICAgICBkZXBzOiBbTG9jYWxTdG9yYWdlU2VydmljZSwgRmV0Y2hBZGFwdGVyLCBJbmplY3Rvcl0sXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7IHByb3ZpZGU6IEhUVFBfSU5URVJDRVBUT1JTLCB1c2VDbGFzczogRGVmYXVsdEludGVyY2VwdG9yLCBtdWx0aTogdHJ1ZSB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcHJvdmlkZTogQVBQX0lOSVRJQUxJWkVSLFxyXG4gICAgICAgICAgICBtdWx0aTogdHJ1ZSxcclxuICAgICAgICAgICAgdXNlRmFjdG9yeTogaW5pdGlhbGl6ZVNlcnZlckNvbmZpZ1NlcnZpY2UsXHJcbiAgICAgICAgICAgIGRlcHM6IFtTZXJ2ZXJDb25maWdTZXJ2aWNlXSxcclxuICAgICAgICB9LFxyXG4gICAgXSxcclxufSlcclxuZXhwb3J0IGNsYXNzIERhdGFNb2R1bGUge31cclxuIl19