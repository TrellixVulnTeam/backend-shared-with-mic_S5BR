import { ADD_MANUAL_PAYMENT_TO_ORDER, ADD_NOTE_TO_ORDER, CANCEL_ORDER, CREATE_FULFILLMENT, DELETE_ORDER_NOTE, GET_ORDER, GET_ORDERS_LIST, GET_ORDER_HISTORY, GET_ORDER_SUMMARY, MODIFY_ORDER, REFUND_ORDER, SETTLE_PAYMENT, SETTLE_REFUND, TRANSITION_FULFILLMENT_TO_STATE, TRANSITION_ORDER_TO_STATE, TRANSITION_PAYMENT_TO_STATE, UPDATE_ORDER_CUSTOM_FIELDS, UPDATE_ORDER_NOTE, } from '../definitions/order-definitions';
export class OrderDataService {
    constructor(baseDataService) {
        this.baseDataService = baseDataService;
    }
    getOrders(options = { take: 10 }) {
        return this.baseDataService.query(GET_ORDERS_LIST, {
            options,
        });
    }
    getOrder(id) {
        return this.baseDataService.query(GET_ORDER, { id });
    }
    getOrderHistory(id, options) {
        return this.baseDataService.query(GET_ORDER_HISTORY, {
            id,
            options,
        });
    }
    settlePayment(id) {
        return this.baseDataService.mutate(SETTLE_PAYMENT, {
            id,
        });
    }
    transitionPaymentToState(id, state) {
        return this.baseDataService.mutate(TRANSITION_PAYMENT_TO_STATE, {
            id,
            state,
        });
    }
    createFulfillment(input) {
        return this.baseDataService.mutate(CREATE_FULFILLMENT, {
            input,
        });
    }
    transitionFulfillmentToState(id, state) {
        return this.baseDataService.mutate(TRANSITION_FULFILLMENT_TO_STATE, {
            id,
            state,
        });
    }
    cancelOrder(input) {
        return this.baseDataService.mutate(CANCEL_ORDER, {
            input,
        });
    }
    refundOrder(input) {
        return this.baseDataService.mutate(REFUND_ORDER, {
            input,
        });
    }
    settleRefund(input, orderId) {
        return this.baseDataService.mutate(SETTLE_REFUND, {
            input,
        });
    }
    addNoteToOrder(input) {
        return this.baseDataService.mutate(ADD_NOTE_TO_ORDER, {
            input,
        });
    }
    updateOrderNote(input) {
        return this.baseDataService.mutate(UPDATE_ORDER_NOTE, {
            input,
        });
    }
    deleteOrderNote(id) {
        return this.baseDataService.mutate(DELETE_ORDER_NOTE, {
            id,
        });
    }
    transitionToState(id, state) {
        return this.baseDataService.mutate(TRANSITION_ORDER_TO_STATE, {
            id,
            state,
        });
    }
    updateOrderCustomFields(input) {
        return this.baseDataService.mutate(UPDATE_ORDER_CUSTOM_FIELDS, {
            input,
        });
    }
    getOrderSummary(start, end) {
        return this.baseDataService.query(GET_ORDER_SUMMARY, {
            start: start.toISOString(),
            end: end.toISOString(),
        });
    }
    modifyOrder(input) {
        return this.baseDataService.mutate(MODIFY_ORDER, {
            input,
        });
    }
    addManualPaymentToOrder(input) {
        return this.baseDataService.mutate(ADD_MANUAL_PAYMENT_TO_ORDER, { input });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3JkZXItZGF0YS5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2xpYi9jb3JlL3NyYy9kYXRhL3Byb3ZpZGVycy9vcmRlci1kYXRhLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBK0JBLE9BQU8sRUFDSCwyQkFBMkIsRUFDM0IsaUJBQWlCLEVBQ2pCLFlBQVksRUFDWixrQkFBa0IsRUFDbEIsaUJBQWlCLEVBQ2pCLFNBQVMsRUFDVCxlQUFlLEVBQ2YsaUJBQWlCLEVBQ2pCLGlCQUFpQixFQUNqQixZQUFZLEVBQ1osWUFBWSxFQUNaLGNBQWMsRUFDZCxhQUFhLEVBQ2IsK0JBQStCLEVBQy9CLHlCQUF5QixFQUN6QiwyQkFBMkIsRUFDM0IsMEJBQTBCLEVBQzFCLGlCQUFpQixHQUNwQixNQUFNLGtDQUFrQyxDQUFDO0FBSTFDLE1BQU0sT0FBTyxnQkFBZ0I7SUFDekIsWUFBb0IsZUFBZ0M7UUFBaEMsb0JBQWUsR0FBZixlQUFlLENBQWlCO0lBQUcsQ0FBQztJQUV4RCxTQUFTLENBQUMsVUFBNEIsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFO1FBQzlDLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQTZDLGVBQWUsRUFBRTtZQUMzRixPQUFPO1NBQ1YsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVELFFBQVEsQ0FBQyxFQUFVO1FBQ2YsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBcUMsU0FBUyxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUM3RixDQUFDO0lBRUQsZUFBZSxDQUFDLEVBQVUsRUFBRSxPQUFpQztRQUN6RCxPQUFPLElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUM3QixpQkFBaUIsRUFDakI7WUFDSSxFQUFFO1lBQ0YsT0FBTztTQUNWLENBQ0osQ0FBQztJQUNOLENBQUM7SUFFRCxhQUFhLENBQUMsRUFBVTtRQUNwQixPQUFPLElBQUks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XHJcbiAgICBBZGRNYW51YWxQYXltZW50LFxyXG4gICAgQWRkTm90ZVRvT3JkZXIsXHJcbiAgICBBZGROb3RlVG9PcmRlcklucHV0LFxyXG4gICAgQ2FuY2VsT3JkZXIsXHJcbiAgICBDYW5jZWxPcmRlcklucHV0LFxyXG4gICAgQ3JlYXRlRnVsZmlsbG1lbnQsXHJcbiAgICBEZWxldGVPcmRlck5vdGUsXHJcbiAgICBGdWxmaWxsT3JkZXJJbnB1dCxcclxuICAgIEdldE9yZGVyLFxyXG4gICAgR2V0T3JkZXJIaXN0b3J5LFxyXG4gICAgR2V0T3JkZXJMaXN0LFxyXG4gICAgR2V0T3JkZXJTdW1tYXJ5LFxyXG4gICAgSGlzdG9yeUVudHJ5TGlzdE9wdGlvbnMsXHJcbiAgICBNYW51YWxQYXltZW50SW5wdXQsXHJcbiAgICBNb2RpZnlPcmRlcixcclxuICAgIE1vZGlmeU9yZGVySW5wdXQsXHJcbiAgICBPcmRlckxpc3RPcHRpb25zLFxyXG4gICAgUmVmdW5kT3JkZXIsXHJcbiAgICBSZWZ1bmRPcmRlcklucHV0LFxyXG4gICAgU2V0dGxlUGF5bWVudCxcclxuICAgIFNldHRsZVJlZnVuZCxcclxuICAgIFNldHRsZVJlZnVuZElucHV0LFxyXG4gICAgVHJhbnNpdGlvbkZ1bGZpbGxtZW50VG9TdGF0ZSxcclxuICAgIFRyYW5zaXRpb25PcmRlclRvU3RhdGUsXHJcbiAgICBUcmFuc2l0aW9uUGF5bWVudFRvU3RhdGUsXHJcbiAgICBVcGRhdGVPcmRlckN1c3RvbUZpZWxkcyxcclxuICAgIFVwZGF0ZU9yZGVySW5wdXQsXHJcbiAgICBVcGRhdGVPcmRlck5vdGUsXHJcbiAgICBVcGRhdGVPcmRlck5vdGVJbnB1dCxcclxufSBmcm9tICcuLi8uLi9jb21tb24vZ2VuZXJhdGVkLXR5cGVzJztcclxuaW1wb3J0IHtcclxuICAgIEFERF9NQU5VQUxfUEFZTUVOVF9UT19PUkRFUixcclxuICAgIEFERF9OT1RFX1RPX09SREVSLFxyXG4gICAgQ0FOQ0VMX09SREVSLFxyXG4gICAgQ1JFQVRFX0ZVTEZJTExNRU5ULFxyXG4gICAgREVMRVRFX09SREVSX05PVEUsXHJcbiAgICBHRVRfT1JERVIsXHJcbiAgICBHRVRfT1JERVJTX0xJU1QsXHJcbiAgICBHRVRfT1JERVJfSElTVE9SWSxcclxuICAgIEdFVF9PUkRFUl9TVU1NQVJZLFxyXG4gICAgTU9ESUZZX09SREVSLFxyXG4gICAgUkVGVU5EX09SREVSLFxyXG4gICAgU0VUVExFX1BBWU1FTlQsXHJcbiAgICBTRVRUTEVfUkVGVU5ELFxyXG4gICAgVFJBTlNJVElPTl9GVUxGSUxMTUVOVF9UT19TVEFURSxcclxuICAgIFRSQU5TSVRJT05fT1JERVJfVE9fU1RBVEUsXHJcbiAgICBUUkFOU0lUSU9OX1BBWU1FTlRfVE9fU1RBVEUsXHJcbiAgICBVUERBVEVfT1JERVJfQ1VTVE9NX0ZJRUxEUyxcclxuICAgIFVQREFURV9PUkRFUl9OT1RFLFxyXG59IGZyb20gJy4uL2RlZmluaXRpb25zL29yZGVyLWRlZmluaXRpb25zJztcclxuXHJcbmltcG9ydCB7IEJhc2VEYXRhU2VydmljZSB9IGZyb20gJy4vYmFzZS1kYXRhLnNlcnZpY2UnO1xyXG5cclxuZXhwb3J0IGNsYXNzIE9yZGVyRGF0YVNlcnZpY2Uge1xyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBiYXNlRGF0YVNlcnZpY2U6IEJhc2VEYXRhU2VydmljZSkge31cclxuXHJcbiAgICBnZXRPcmRlcnMob3B0aW9uczogT3JkZXJMaXN0T3B0aW9ucyA9IHsgdGFrZTogMTAgfSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5xdWVyeTxHZXRPcmRlckxpc3QuUXVlcnksIEdldE9yZGVyTGlzdC5WYXJpYWJsZXM+KEdFVF9PUkRFUlNfTElTVCwge1xyXG4gICAgICAgICAgICBvcHRpb25zLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGdldE9yZGVyKGlkOiBzdHJpbmcpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UucXVlcnk8R2V0T3JkZXIuUXVlcnksIEdldE9yZGVyLlZhcmlhYmxlcz4oR0VUX09SREVSLCB7IGlkIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGdldE9yZGVySGlzdG9yeShpZDogc3RyaW5nLCBvcHRpb25zPzogSGlzdG9yeUVudHJ5TGlzdE9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UucXVlcnk8R2V0T3JkZXJIaXN0b3J5LlF1ZXJ5LCBHZXRPcmRlckhpc3RvcnkuVmFyaWFibGVzPihcclxuICAgICAgICAgICAgR0VUX09SREVSX0hJU1RPUlksXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlkLFxyXG4gICAgICAgICAgICAgICAgb3B0aW9ucyxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHNldHRsZVBheW1lbnQoaWQ6IHN0cmluZykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8U2V0dGxlUGF5bWVudC5NdXRhdGlvbiwgU2V0dGxlUGF5bWVudC5WYXJpYWJsZXM+KFNFVFRMRV9QQVlNRU5ULCB7XHJcbiAgICAgICAgICAgIGlkLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHRyYW5zaXRpb25QYXltZW50VG9TdGF0ZShpZDogc3RyaW5nLCBzdGF0ZTogc3RyaW5nKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLm11dGF0ZTxcclxuICAgICAgICAgICAgVHJhbnNpdGlvblBheW1lbnRUb1N0YXRlLk11dGF0aW9uLFxyXG4gICAgICAgICAgICBUcmFuc2l0aW9uUGF5bWVudFRvU3RhdGUuVmFyaWFibGVzXHJcbiAgICAgICAgPihUUkFOU0lUSU9OX1BBWU1FTlRfVE9fU1RBVEUsIHtcclxuICAgICAgICAgICAgaWQsXHJcbiAgICAgICAgICAgIHN0YXRlLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZUZ1bGZpbGxtZW50KGlucHV0OiBGdWxmaWxsT3JkZXJJbnB1dCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8Q3JlYXRlRnVsZmlsbG1lbnQuTXV0YXRpb24sIENyZWF0ZUZ1bGZpbGxtZW50LlZhcmlhYmxlcz4oXHJcbiAgICAgICAgICAgIENSRUFURV9GVUxGSUxMTUVOVCxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaW5wdXQsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICB0cmFuc2l0aW9uRnVsZmlsbG1lbnRUb1N0YXRlKGlkOiBzdHJpbmcsIHN0YXRlOiBzdHJpbmcpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPFxyXG4gICAgICAgICAgICBUcmFuc2l0aW9uRnVsZmlsbG1lbnRUb1N0YXRlLk11dGF0aW9uLFxyXG4gICAgICAgICAgICBUcmFuc2l0aW9uRnVsZmlsbG1lbnRUb1N0YXRlLlZhcmlhYmxlc1xyXG4gICAgICAgID4oVFJBTlNJVElPTl9GVUxGSUxMTUVOVF9UT19TVEFURSwge1xyXG4gICAgICAgICAgICBpZCxcclxuICAgICAgICAgICAgc3RhdGUsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2FuY2VsT3JkZXIoaW5wdXQ6IENhbmNlbE9yZGVySW5wdXQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPENhbmNlbE9yZGVyLk11dGF0aW9uLCBDYW5jZWxPcmRlci5WYXJpYWJsZXM+KENBTkNFTF9PUkRFUiwge1xyXG4gICAgICAgICAgICBpbnB1dCxcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZWZ1bmRPcmRlcihpbnB1dDogUmVmdW5kT3JkZXJJbnB1dCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8UmVmdW5kT3JkZXIuTXV0YXRpb24sIFJlZnVuZE9yZGVyLlZhcmlhYmxlcz4oUkVGVU5EX09SREVSLCB7XHJcbiAgICAgICAgICAgIGlucHV0LFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHNldHRsZVJlZnVuZChpbnB1dDogU2V0dGxlUmVmdW5kSW5wdXQsIG9yZGVySWQ6IHN0cmluZykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8U2V0dGxlUmVmdW5kLk11dGF0aW9uLCBTZXR0bGVSZWZ1bmQuVmFyaWFibGVzPihTRVRUTEVfUkVGVU5ELCB7XHJcbiAgICAgICAgICAgIGlucHV0LFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZE5vdGVUb09yZGVyKGlucHV0OiBBZGROb3RlVG9PcmRlcklucHV0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLm11dGF0ZTxBZGROb3RlVG9PcmRlci5NdXRhdGlvbiwgQWRkTm90ZVRvT3JkZXIuVmFyaWFibGVzPihcclxuICAgICAgICAgICAgQUREX05PVEVfVE9fT1JERVIsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlucHV0LFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlT3JkZXJOb3RlKGlucHV0OiBVcGRhdGVPcmRlck5vdGVJbnB1dCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8VXBkYXRlT3JkZXJOb3RlLk11dGF0aW9uLCBVcGRhdGVPcmRlck5vdGUuVmFyaWFibGVzPihcclxuICAgICAgICAgICAgVVBEQVRFX09SREVSX05PVEUsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlucHV0LFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlT3JkZXJOb3RlKGlkOiBzdHJpbmcpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPERlbGV0ZU9yZGVyTm90ZS5NdXRhdGlvbiwgRGVsZXRlT3JkZXJOb3RlLlZhcmlhYmxlcz4oXHJcbiAgICAgICAgICAgIERFTEVURV9PUkRFUl9OT1RFLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHRyYW5zaXRpb25Ub1N0YXRlKGlkOiBzdHJpbmcsIHN0YXRlOiBzdHJpbmcpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPFRyYW5zaXRpb25PcmRlclRvU3RhdGUuTXV0YXRpb24sIFRyYW5zaXRpb25PcmRlclRvU3RhdGUuVmFyaWFibGVzPihcclxuICAgICAgICAgICAgVFJBTlNJVElPTl9PUkRFUl9UT19TVEFURSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWQsXHJcbiAgICAgICAgICAgICAgICBzdGF0ZSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZU9yZGVyQ3VzdG9tRmllbGRzKGlucHV0OiBVcGRhdGVPcmRlcklucHV0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLm11dGF0ZTxcclxuICAgICAgICAgICAgVXBkYXRlT3JkZXJDdXN0b21GaWVsZHMuTXV0YXRpb24sXHJcbiAgICAgICAgICAgIFVwZGF0ZU9yZGVyQ3VzdG9tRmllbGRzLlZhcmlhYmxlc1xyXG4gICAgICAgID4oVVBEQVRFX09SREVSX0NVU1RPTV9GSUVMRFMsIHtcclxuICAgICAgICAgICAgaW5wdXQsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0T3JkZXJTdW1tYXJ5KHN0YXJ0OiBEYXRlLCBlbmQ6IERhdGUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UucXVlcnk8R2V0T3JkZXJTdW1tYXJ5LlF1ZXJ5LCBHZXRPcmRlclN1bW1hcnkuVmFyaWFibGVzPihcclxuICAgICAgICAgICAgR0VUX09SREVSX1NVTU1BUlksXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHN0YXJ0OiBzdGFydC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgZW5kOiBlbmQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIG1vZGlmeU9yZGVyKGlucHV0OiBNb2RpZnlPcmRlcklucHV0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLm11dGF0ZTxNb2RpZnlPcmRlci5NdXRhdGlvbiwgTW9kaWZ5T3JkZXIuVmFyaWFibGVzPihNT0RJRllfT1JERVIsIHtcclxuICAgICAgICAgICAgaW5wdXQsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkTWFudWFsUGF5bWVudFRvT3JkZXIoaW5wdXQ6IE1hbnVhbFBheW1lbnRJbnB1dCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8QWRkTWFudWFsUGF5bWVudC5NdXRhdGlvbiwgQWRkTWFudWFsUGF5bWVudC5WYXJpYWJsZXM+KFxyXG4gICAgICAgICAgICBBRERfTUFOVUFMX1BBWU1FTlRfVE9fT1JERVIsXHJcbiAgICAgICAgICAgIHsgaW5wdXQgfSxcclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==