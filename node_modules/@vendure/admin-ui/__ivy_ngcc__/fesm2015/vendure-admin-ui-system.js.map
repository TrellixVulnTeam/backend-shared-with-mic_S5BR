{"version":3,"file":"vendure-admin-ui-system.js","sources":["../../src/lib/system/src/components/health-check/health-check.component.ts","../../src/lib/system/src/components/job-list/job-list.component.ts","../../src/lib/system/src/components/job-state-label/job-state-label.component.ts","../../src/lib/system/src/system.routes.ts","../../src/lib/system/src/system.module.ts","../../src/lib/system/src/public_api.ts","../../src/lib/system/src/vendure-admin-ui-system.ts"],"names":["_"],"mappings":"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","sourcesContent":["import { ChangeDetectionStrategy, Component } from '@angular/core';\r\nimport { HealthCheckService } from '@vendure/admin-ui/core';\r\n\r\n@Component({\r\n    selector: 'vdr-health-check',\r\n    templateUrl: './health-check.component.html',\r\n    styleUrls: ['./health-check.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class HealthCheckComponent {\r\n    constructor(public healthCheckService: HealthCheckService) {}\r\n}\r\n","import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\r\nimport { FormControl } from '@angular/forms';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport {\r\n    BaseListComponent,\r\n    DataService,\r\n    GetAllJobs,\r\n    GetFacetList,\r\n    GetJobQueueList,\r\n    ModalService,\r\n    NotificationService,\r\n    SortOrder,\r\n} from '@vendure/admin-ui/core';\r\nimport { Observable, timer } from 'rxjs';\r\nimport { filter, map, takeUntil } from 'rxjs/operators';\r\n\r\n@Component({\r\n    selector: 'vdr-job-list',\r\n    templateUrl: './job-list.component.html',\r\n    styleUrls: ['./job-list.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class JobListComponent\r\n    extends BaseListComponent<GetAllJobs.Query, GetAllJobs.Items>\r\n    implements OnInit {\r\n    queues$: Observable<GetJobQueueList.JobQueues[]>;\r\n    liveUpdate = new FormControl(true);\r\n    hideSettled = new FormControl(true);\r\n    queueFilter = new FormControl('all');\r\n\r\n    constructor(\r\n        private dataService: DataService,\r\n        private modalService: ModalService,\r\n        private notificationService: NotificationService,\r\n        router: Router,\r\n        route: ActivatedRoute,\r\n    ) {\r\n        super(router, route);\r\n        super.setQueryFn(\r\n            (...args: any[]) => this.dataService.settings.getAllJobs(...args),\r\n            data => data.jobs,\r\n            (skip, take) => {\r\n                const queueFilter =\r\n                    this.queueFilter.value === 'all' ? null : { queueName: { eq: this.queueFilter.value } };\r\n                const hideSettled = this.hideSettled.value;\r\n                return {\r\n                    options: {\r\n                        skip,\r\n                        take,\r\n                        filter: {\r\n                            ...queueFilter,\r\n                            ...(hideSettled ? { isSettled: { eq: false } } : {}),\r\n                        },\r\n                        sort: {\r\n                            createdAt: SortOrder.DESC,\r\n                        },\r\n                    },\r\n                };\r\n            },\r\n        );\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        timer(5000, 2000)\r\n            .pipe(\r\n                takeUntil(this.destroy$),\r\n                filter(() => this.liveUpdate.value),\r\n            )\r\n            .subscribe(() => {\r\n                this.refresh();\r\n            });\r\n        this.queues$ = this.dataService.settings\r\n            .getJobQueues()\r\n            .mapStream(res => res.jobQueues)\r\n            .pipe(\r\n                map(queues => {\r\n                    return [{ name: 'all', running: true }, ...queues];\r\n                }),\r\n            );\r\n    }\r\n\r\n    hasResult(job: GetAllJobs.Items): boolean {\r\n        const result = job.result;\r\n        if (result == null) {\r\n            return false;\r\n        }\r\n        if (typeof result === 'object') {\r\n            return Object.keys(result).length > 0;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    cancelJob(id: string) {\r\n        this.dataService.settings.cancelJob(id).subscribe(() => this.refresh());\r\n    }\r\n}\r\n","import { ChangeDetectionStrategy, Component, Input } from '@angular/core';\r\nimport { JobInfoFragment, JobState } from '@vendure/admin-ui/core';\r\n\r\n@Component({\r\n    selector: 'vdr-job-state-label',\r\n    templateUrl: './job-state-label.component.html',\r\n    styleUrls: ['./job-state-label.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class JobStateLabelComponent {\r\n    @Input()\r\n    job: JobInfoFragment;\r\n\r\n    get iconShape(): string {\r\n        switch (this.job.state) {\r\n            case JobState.COMPLETED:\r\n                return 'check-circle';\r\n            case JobState.FAILED:\r\n                return 'exclamation-circle';\r\n            case JobState.CANCELLED:\r\n                return 'ban';\r\n            case JobState.PENDING:\r\n            case JobState.RETRYING:\r\n                return 'hourglass';\r\n            case JobState.RUNNING:\r\n                return 'sync';\r\n        }\r\n    }\r\n\r\n    get colorType(): string {\r\n        switch (this.job.state) {\r\n            case JobState.COMPLETED:\r\n                return 'success';\r\n            case JobState.FAILED:\r\n            case JobState.CANCELLED:\r\n                return 'error';\r\n            case JobState.PENDING:\r\n            case JobState.RETRYING:\r\n                return '';\r\n            case JobState.RUNNING:\r\n                return 'warning';\r\n        }\r\n    }\r\n}\r\n","import { Route } from '@angular/router';\r\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\r\n\r\nimport { HealthCheckComponent } from './components/health-check/health-check.component';\r\nimport { JobListComponent } from './components/job-list/job-list.component';\r\n\r\nexport const systemRoutes: Route[] = [\r\n    {\r\n        path: 'jobs',\r\n        component: JobListComponent,\r\n        data: {\r\n            breadcrumb: _('breadcrumb.job-queue'),\r\n        },\r\n    },\r\n    {\r\n        path: 'system-status',\r\n        component: HealthCheckComponent,\r\n        data: {\r\n            breadcrumb: _('breadcrumb.system-status'),\r\n        },\r\n    },\r\n];\r\n","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { RouterModule } from '@angular/router';\r\nimport { SharedModule } from '@vendure/admin-ui/core';\r\n\r\nimport { HealthCheckComponent } from './components/health-check/health-check.component';\r\nimport { JobListComponent } from './components/job-list/job-list.component';\r\nimport { JobStateLabelComponent } from './components/job-state-label/job-state-label.component';\r\nimport { systemRoutes } from './system.routes';\r\n\r\n@NgModule({\r\n    declarations: [HealthCheckComponent, JobListComponent, JobStateLabelComponent],\r\n    imports: [SharedModule, RouterModule.forChild(systemRoutes)],\r\n})\r\nexport class SystemModule {}\r\n","// This file was generated by the build-public-api.ts script\nexport * from './components/health-check/health-check.component';\nexport * from './components/job-list/job-list.component';\nexport * from './components/job-state-label/job-state-label.component';\nexport * from './system.module';\nexport * from './system.routes';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"]}